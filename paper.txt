Koopman ᷆࠼фᓊ用᪎ 㾷现实中的大多数系统往往由于原理复杂而难以用比较准确的动力学方程来近似描述，只能通常用大量的实验观测得到系统的特性数据。我们希望能找到一个普遍的数据分析方法，通过系统的特性数据，提取出动力学系统的动力学模式。 Koopman 算符提供了一个有效的数学工具，它作用在某个函数上，描述了函数的演化，若将系统的特性数据演化视为函数的演化，我们即可以用 Koopman 算符分析系统的演化特征，并进一步提取出关键特征，并可以对系统的长期行为作一定程度的预测。我们在一些常见的混沌系统上（例如 Logistic 映射， Hénon 映射， Lorenz 系统）应用 Koopman 算符进行谱分解，有效地提取出混沌系统的特征，并对 Koopman 算符的本征值与本征函数作了一些物理解释。由于 Koopman算符的普适性，我们可以将 Koopman 分析应用到一般的复杂系统中。
关䭤䈃φ Koopman 算符 动力学模式 谱分解 混沌映射IKOOPMAN ANALYSIS AND APPLICATION OF CHAOTICMAPABSTRACTMost systems in reality are often difficult to approximate with accurate dynamical equations due to their complexity, and experimental observations canbe used solely to obtain system characteristic data. We hope to find a universaldata analysis method to extract key dynamics features underlying a nonlinearsystem through the characteristic data. The Koopman operator provides an effective mathematical tool, which acts on certain functions and describes theirevolution. Based on the time series of the system’s evolution, we can use theKoopman operator to analyze the temporal characteristics of the system, andextract key dynamical factors, and predict the long-term behavior of the systemto certain extent. We apply the Koopman operator technique to spectral decomposition of several typical chaotic systems (e.g. Logistic map, Hénon map andLorenz system), effectively extract their key features, and explain the eigenvalues and eigenfunctions of the Koopman operator. Because of the universalityof the analysis, we may apply it to general complex systems.
KEY WORDS: Koopman Operator Dynamic model Spectral Decomposition Chaotic Systems

第一章 引言ㅢжㄖ ᕋ䀶当今时代是一个信息时代，社会的发展充斥着各种信息交换，包括机械、能源、交通、化工、生物、航空航天等各项领域，然而在信息传递中愈发庞大的信息量中，如何有效的提取关键的信息是一个亟待解决的问题。
信息的具体表现形式是数据，数据和信息直接是相互联系的，数据是反映客观事物属性的记录。数据经过加工处理之后，就成为信息，而信息需要经过数字化转变成数据才能存储和传输。因此，数据分析也成为当下的一个热点问题。
随着数学与计算机等领域的发展，测量技术和计算能力的巨大改进，数据分析已成为一门新兴的学科应用在各个领域，并将继续发展。然而数据分析的方法多种多样，不同的数据分析方法的有效性也不同，很多数据的分析方法都依赖于数据的数学特征。我们寄希望于找到一个普遍的数据分析方法，通过研究数据从而了解其内部的抽象结构。
在许多实际系统中，我们通常可以得到一系列关于该系统的丰富数据，然而由于不了解其动力学原理或者系统过于复杂等原因无法用比较准确的动力学方程来近似描述。为了了解和研究这些系统，通常进行大量的实验或观测得到系统的特性数据。我们希望能够找到一种方法，仅通过系统数据的演化过程得到系统的一些演化特征，并在这些演化特征中提取出关键特征。如果我们能提取出复杂系统的关键特征，就能通过分析实际复杂系统的长期行为，并对系统的行为作出一定程度的预测。
在我们的现实生活中，若将各种事件抽象为一种数据，并能提取出关键特征并进行预测，将具有很大的现实意义。
1.1 Koopman ㇍ㅜф࣑ࣞ㌱㔕的⢯ᖷᨆ਌我们希望能够找到一种方法，仅通过系统数据的演化过程得到系统的一些演化特征，并在这些演化特征中提取出关键特征。 Koopman 算符给我们提供了一个有效的数学工具。 Koopman 算法由 B.O.Koopman 与 1931 年引入，它作用在某个函数上，描述了函数的演化。若将系统的特性数据演化视为函数的演化，我们即可以用Koopman 算符分析系统的特征。
Koopman 分析方法仅由系统的特性数据得到，理论上在数据足够多的情况下，1我们可以得到系统的一切特征，如何提取出关键的系统特征（或者说是我们想要的系统特征）也是一个很复杂的问题；另一方面，我们在实际应用中的数据总是有限的，也会存在一定的误差，于是复杂系统的 Koopman 分析依赖于大量的系统数据支持。为了简化计算复杂度，而又不失 Koopman 分析的核心思想，我们可以先选取某些已知的动力学系统作为 Koopman 分析的对象。
线性的动力学系统通过经典的动力学理论已经能够得到较好的解析分析方法，而非线性动力学系统的分析方法也有诸多理论用于系统的分析，比如通过不动点的线性化分析得到不动点近邻区域的系统演化特征。而对于复杂的非线性动力学系统比如混沌系统，传统的非线性动力学分析方法有其局限性。我们试图将 Koopman 分析应用在某些混沌系统上，提取出混沌系统的系统特征，如果能抓住混沌系统的主要特征并进行定量的分析，就可以分析出混沌系统的长期行为，从而对混沌系统做一定程度上的预测。
混沌系统按照系统方程可以分为混沌映射（离散混沌系统）与混沌流（连续混沌系统），其本质是相同的。但由于在分析过程中需要用到数值计算，而数值计算对混沌映射与混沌流的影响是不同的：混沌映射的数值计算误差来源主要依赖于计算机的精度误差；混沌流的数值计算误差来源除了计算机的精度误差，其主要误差来源于系统时间间隔的选取。另一方面，混沌流的数值计算过程也可以转变为一个关于系统时间间隔的映射系统。因此，我们的 Koopman 分析方法以混沌映射系统为基础，分别讨论混沌映射系统与混沌流系统。
混沌系统按照系统维度可以分为一维、二维、三维与高维系统，不同维度的混沌系统在计算方法与计算复杂度上有一定区别。有一些常见的混沌系统，比如 Logistic映射（一维映射）， Hénon 映射（二维映射）， Standard 映射（二维映射）， Lorenz 系统（三维流），我们将选取几个典型的混沌系统作为分析对象，以验证 Koopman 分析的有效性。
通过对上述一些常见的混沌系统的 Koopman 分析，我们可以构造出每个系统下的数据矩阵，进一步计算出 Koopman 算符的矩阵表示以及本征值、本征函数。每个本征函数都代表了该系统的一种动力学模式，我们可以得到每个系统的很多本征函数，且本征函数的数量与相空间的数据点的数量相同，然而很多本征函数都是高度抽象的，很多本征函数反映了相同的动力学模式，而我们的工作就是提取出每个系统不同的动力学模式。
在混沌系统中的 Koopman 分析可以为我们在以后实际应用中更复杂的非线性2第一章 引言系统打下基础。通过已知的混沌系统的 Koopman 分析方式，我们可以观察到计算Koopman 算符的本征函数时，不同的参数对本征函数的影响，比如基函数的形式、基函数的数量、基函数的分布、演化格点的分布等。在了解不同的参数对混沌系统的影响后，我们可以将 Koopman 分析方法应用到实际的复杂系统中。在实际的复杂系统中，我们可以采用与混沌系统同样的分析方法，即使系统非常复杂，我们也无需知道系统的工作内部机制以及动力学方程，只需要得到系统的状态演化过程，便能对复杂系统进行 Koopman 分析，并提取复杂系统的关键特征，从而分析复杂系统的长期行为，并对某些系统行为做出预测。
1.2 ള޻ཌ的⹊ガ⧦⣬关于数据分析与数据预测的方法有诸多理论。在本研究课题中采取 Koopman 算符进行数据的分析与预测。 Koopman 算符由 B. O. Koopman 于 1931 年提出，能够描述系统可观察量随时间的演化，并可用来研究动力系统的各态历经性质，随后被证明与 Liouville 算符有着紧密联系。其早期的相关工作主要集中于统计力学系统和非线性动力系统中 Koopman 算符谱性质的解析研究。 Mezić 曾在 2004 年的一篇文章中探讨了利用 Koopman 算符的某些本征函数对确定性以及随机非线性动力系统进行各态历经划分的理论和方法，然后于 2005 年发表的文章中再次对 Koopman 算符进行了谱分析的理论研究，并根据结论提出了可以利用其谱特征对高维动力系统（如流体系统和生物分子系统）进行模型简化的可能性。， 2009 年 Rowley、 Mezić 等发表了第一篇有关 Koopman 算符谱分析应用于流体力学中的文章，文章中介绍了基于Arnoldi 算法的 Koopman 谱分析和模式分解方法：利用流体系统速度场的测量数据，构建 Koopman 算符的矩阵表示，然后通过特征分解得到一系列本征值及对应的本征模式（Koopman 模式）。其中，每一个 Koopman 模式都描述了非线性系统的一种动力学特征，相应本征值则描述了该模式的变化规律。 Budisic 等人在 2012 年总结了Koopman 谱分析的理论和应用：在给定系统数据中，可以求得 Koopman 算符的三种特性量，分别为本征值、本征函数和 Koopman 模式。其中本征函数可以用于对系统进行各态历经的划分， Koopman 模式则用来简化模型以及研究不同变量之间的相关性。 Steven 等人在 2017 年提出了另一种 Koopman 分析的观点（HAVOK）并用 SVD及时间延迟嵌入定理对常见的混沌系统做出分析，并预测了波峰出现的时机。
31.3 ᵢ文ѱ㾷޻ᇯ਀ᡆ᷒本文介绍了动力学系统与混沌系统的动力学，并利用 Koopman 算符分析一些常见混沌系统的动力学，在低维系统对动力学系统的相空间进行划分。 Koopman 算符通过计算本征值与本征函数能与符号动力学的边界点获得一致的划分，且可以通过控制基函数数量的精度来减小误差。这种方法为符号动力学和 Koopman 算符的本征函数建立了联系，并且这种寻找符号动力学边界的方法相较于计算集合拓扑结构更容易计算和实现，也更容易推广到一般的非线性系统。
在第二章中首先在 2.1 节介绍了动力学系统的基础知识，动力学系统包含线性动力学系统和非线性动力学系统； 2.2 节介绍了一种特殊的非线性动力学系统–混沌系统； 2.3 节介绍了 Koopman 算符的基本知识，包括 Koopman 算符的定义、本征值与本征函数、 Koopman 算符谱与 Koopman 算符的函数空间； 2.4 节将 Koopman 算符与动力学系统结合，介绍了符号动力学的边界点与动力学系统的线性化与周期轨道，说明了 Koopman 算符与动力学系统的联系。
在第三章中主要介绍了一些常见的混沌系统中 Koopman 算符的应用：在一维系统中的帐篷映射、 Logistic 映射，二维系统中的 Hénon 映射，三维系统中的洛伦兹系统。在每个系统中，我们通过分析动力学系统的动力学，并计算 Koopman 算符的本征值和本征函数，来探究其之间的对应关系，以寻找出 Koopman 算符对动力学系统的动力学划分，我们还对低维系统中 Koopman 分析的鲁棒性、准确性和普适性进行了进一步的讨论，最后分析了 Koopman 算符在分析动力学系统模式与相空间划分的有效性。
最后第四章对本文进行了总结，并提出了 Koopman 算符的改进空间及展望。
4第二章 动力学系统与 Koopman 算符ㅢӂㄖ ࣑ࣞᆜ㌱㔕ф Koopman ㇍ㅜ2.1 ࣑ࣞᆜ㌱㔕动力学研究的是系统是如何随时间变化，以及这些变化的规律。这些系统的性质或者是特征是由一些所谓的状态变量所表征，如哈密顿系统中粒子的坐标和动量，液体的浓度，人口的密度，粒子的概率密度分布等等。动力学描述这些状态变量随时间的变化的规律。这种规律既可以表示为状态变量的微分方程，也可用关于状态变量的离散方程表示。这些方程既可以是线性的，也可以是非线性的。但在实际中大部分系统都是非线性的，线性方程大多只是非线性方程的近似。
动力学方程包括自治方程 (方程中不显含时间) 与非自治方程（方程中显含时间）之分，但是所有的非线性常微分方程都可以化为自治的一阶常微分方程组，因此我们在后面的讨论中均默认讨论的是一阶自治常微分动力学方程。
对于一般的连续时间的动力学系统，我们可以用微分动力学方程 (2-1) 来描述：
称为系统的⣬ᘷ਎䠅， x˙ 表示状态变量随时间的变化率，下标 i 2 Z(i =1;2;··· ;n) 表示系统的第几个状态变量， n 表示系统的㔪ᓜ， f : Rn ! R 表示系统随时间的演化规律。动力学系统的演化也可以直观的用⴮ഴ 2-1 表示：其中，我们称由所有维度的状态变量 fx1;x2;··· ;xng 所张成的空间称为⴮グ䰪。
对于一般的离散时间的动力学方程，我们可以用离散动力学方程 (2-2) 来描述：
表示离散系统的迭代次数，即离散的时间指标。
连续时间动力学系统的相图2.1.1 㓵性࣑ࣞᆜ㌱㔕在物理学中，我们比较熟悉的系统很多都是用线性方程描述动力学规律，即所谓的线性系统。线性方程很容易求解并且具有一些很简单的特性（如叠加原理）。在(2-1) 中，若 fi(i = 1;2;··· ;n) 均为各自变量的线性函数，则我们的动力学系统即为一线性系统。连续时间线性系统可以用矩阵表示：
x˙ = Ax (2-3)其中 x 表示由所有状态变量构成的列向量， A 为 n×n 的矩阵 (Ai j 2 R)。
离散时间的线性动力学方程也可以用矩阵来表示:
xn+1 = Axn (2-4)其中 x 表示由所有状态变量构成的列向量， A 为 n × n 的矩阵 (Ai j 2 R)，下标 n 表示系统的迭代次数，即离散的时间指标。
例如一个一维的连续时间线性系统 x˙ = 3，很容易求解其运动学方程为 x(t) = 3t,对应我们的一维匀速直线运动；再如系统 x˙ = −2x, 可以求解得到运动学方程为x(t) = Ce−2t（C 为常数）。
6第二章 动力学系统与 Koopman 算符2.1.2 䶔㓵性࣑ࣞᆜ㌱㔕在实际中，许多物理现象乃至其他一些自然现象或者是社会现象毕竟是很复杂的，它们的动力学规律往往需要使用非线性方程表示。这些非线性方程除极少数外，一般都不存在解析解，但是它们却具有与线性方程解的不同的一些独特性质，所以非线性动力学需要一些其他的方法来研究其性质。若在 (2-1) 中，若 fi(i = 1;2;··· ;n)有任意一个为自变量的非线性函数，则我们的动力学系统即为非线性系统。如一维弹性系统x¨+ w2x = 0 (2-5)再如电子管振荡器中的范德波尔方程x¨+ a(x2 − 1)x˙+ w2x = 0 (2-6)我们将满足 x˙ = 0（连续时间系统）和 xn+1 = f (xn) = xn（离散时间系统）的点 x∗称为系统的у。⛯ࣞ在不动点处，系统状态变量不随时间发生变化。在连续时间系统中，我们将满足 Tt∗(x) = x 的轨道称为ઞᵕ䖞䚉，周期为 t∗, 即粒子经过 t∗ 时间后会回到起点; 在离散时间系统中，我们将满足 xn+T = xn 的点称为 T ઞᵕ⛯，周期为T，即粒子经过 T 次迭代又回到了起点。
2.2 ␭⋂㌱㔕混沌是非线性确定动力系统呈现出具有随机性的运动形态，即在一个确定性系统中，存在着貌似随机的不规则运动，其行为表现为不可重复、不可预测，这就是混沌现象。混沌是非线性动力系统的固有特性，是非线性系统普遍存在的现象。混沌具有确定性、初值敏感性、不可预测性。
当系统作一般的规则运动时，无法避涨落所引起的初始条件的微小变化一般只引起运动状态的微小差别，即初始状态接近的轨道始终是接近的，从而人们可以对系统的运动作出预测。然而混沌却不然，它具有对初始条件的敏感依赖性，即初始条件的微小差别常常使轨道按指数形式分开。洛伦兹也曾戏称混沌运动对初始条件的敏感依赖性为“蝴蝶效应”。
对于一个实际系统，由于无法避免内部涨落和外部环境噪声等因素的影响，初始状态的微小差别难以避免，因此混沌对初始状态的这种敏感依赖性必然会导致运动的不确定性与随机性。由于这种随机性，混沌系统在有限的相空间中必然要有折7叠，否则轨线就只能是封闭曲线 (规则的周期运动) 或延伸到无穷远 (发散解)。对于连续时间动力学系统，混沌只可能出现在三维及以上的自治系统 (微分方程中不显含时间) 中。
洛伦兹系统就是 1963 年 E.Lorenz 研究模拟大气在地表受阳光加热时的情形时得到的混沌系统：
8]]]][]]]]:
x˙ = s(y−x)y˙ = x(r −z)−yz˙ = xy−bz(2-7)其中 x、 y、 z 分别为与对流强弱、对流引起的水平温差和垂直方向温差有关的变量，s、 r 和 b 分别与普兰多 (Prandtl) 数、瑞利 (Rayleigh) 数和容器大小有关的参数，在用计算机求上式的数值解时，洛伦兹发现，在参数取适当值时，解具有非周期性与随机性。随后 Henon 和 Rőssler 等人也得到了类似的结果。
李雅普诺夫（Lyapunov）指数是表示相空间相邻轨迹的平均指数发散率的一个数值特征，是描述混沌现象的一个重要指标，对于一个映射 xn+1 = f(xn;a)（a 为参数），其李雅普诺夫指数的计算公式如下：
l(a) = limn!¥1 nn−1∑k=0lnjd f(xk;a)dxj (2-8)其中 a 表示动力学方程中的参数， k 表示演化的离散时间指标。李雅普诺夫指数是用于识别混沌运动的重要特征。当 l [ 0 时，映射系统收敛于某一不动点；当 l = 0时，系统进行周期运动；当 l ] 0 时，系统处于混沌状态。
关于混沌系统性质的讨论有很多，但是一般的方法直接观察系统的状态变量随时间的变化，即使观察时间很长，也不一定能看出规律。如果不对它作进一步的加工分析，很难了解其运动的性质和有关频谱成分等方面的信息，从而难以区分混沌和其他形式的震荡。当运动很复杂时，相空间中的轨迹可能是混乱一片甚至是充满某一区域而看不出什么规律。
为了研究复杂的非线性系统特别是混沌系统，通常有以下几种方法来进一步分析各种运动的特征。 仇䰠䟽ṭ⌋每隔一定时间观察轨迹上的代表点 (采样点)，这样，原来在相空间的连续运动就被一系列离散点 P0、 P1、 P2、 ··· 所代表，不同类型的运动可得到不同形态的采样结果，可以由此来分析其运动的性质。 ᓔࣖ㧧ᡠ䶘⌋在多维相空间 fx1;x2;··· ;xng 中选取一截面 f(xi) = 0(此截面称为庞加莱截面)，观察运动8第二章 动力学系统与 Koopman 算符轨迹与此截面的截点（称为庞加莱点），则原来相空间的连续运动就被就被这些离散点 P0、 P1、 P2、 ··· 之间的映像所表示。 ⴮グ䰪䠃ᶺ⌋选取一时间延迟量 T, 取 x(t)、x(t +T)、 x(t + 2T)、 ···、 x(t +mT) 为坐标画 m 维轨线，这样 m 个维度的变量随时间的变化隐含着整个系统的动力学规律，例如当相空间维度很高时，我们可以取 m = 3来重构高维的相空间，而三维的相空间我们则可以用图来形象化的描述。 ⦽ࣕ䉧⌋是指任意函数都可以展开为一组基函数的线性组合，在物理中可理解为基频和一系列谐频的叠加，我们便可从频域分析原系统的动力学特征。
2.3 Koopman ㇍ㅜKoopman 算符由 B.O.Koopman 于 1931 年引入，它作用在某个函数上，描述了函数的演化。若将系统的特性数据演化视为函数的演化，我们即可以用 Koopman 算符分析系统的特征。现实中的许多系统，由于其动力学的复杂性而难以用较准确的动力学方程来近似描述，而只能得到通过实验或观测得到的系统特征数据。我们希望利用系统的特征数据，通过 Koopman 算符得到系统的动力学特征。
2.3.1 Koopman ㇍ㅜ的ᇐѿ对于离散时间动力学系统，设对于相空间 P 上的任意一点 xp 2 P，有 xp+1 = T(xp)。
其中 p 为迭代次数， T 描述了相空间的迭代规律。定义作用在相空间函数 f (x) 上的Koopman 算符 U, 使得：
U f (x) = f (T(x)) (2-9)对于连续时间动力学系统，设对于相空间 P 上的任意一点 xp 2 P，有 xt = T(x0)。
其中下标 t 为时间， T 描述了相空间随时间的演化规律。定义作用在相空间函数 f (x)上的 Koopman 算符 Ut, 使得：
Utf (x) = f (Tt(x)) (2-10)其中 f (x) 为定义在相空间上的任意可观测函数，如粒子的坐标、动量、浓度、概率密度等等。
给定 f (x)，若令函数 f˜(x) = f (T(x))，则 Koopman 算符可以描述函数的演化U f (x) = f (T(x)) = f˜(x); （离散时间系统）Utf (x) = f (Tt(x)) = f˜t(x); （连续时间系统）(2-11)9例如，对于一个一维线性动力学方程x˙ = −2x (2-12)其运动学方程 x(t) = x(0)e−2t，因此我们可以将其描述为Tt(x) = xe−2t (2-13)设我们有一在相空间的可观测函数f(x) = x2 (2-14)若用 Koopman 算符作用在该函数上，我们可以得到Utf(x) = f(Tt(x)) = f(xe−2t) = x2e−4t = f˜(x) (2-15)即 Koopman 算符作用在函数上，描述了函数的演化x2 −! Ut x2e−4tf(x) −! Ut f˜(x)(2-16)Koopman 算符 U 是无穷维的线性算符，即：
(2-18)则 Koopman 算符可以描述为U f(x) = Un∑i=1aigi(x) =n∑i=1aiUgi(x) =n∑i=1aigi(T(x)) (2-19)即一个复杂函数的演化规律可以描述为一组简单函数演化规律的线性叠加。
2.3.2 Koopman ㇍ㅜ的ᵢᖷٲфᵢᖷ࠳ᮦKoopman 算符 U 是一个线性算符，可以对其进行谱分解。设有一复数 l 和一复标量函数 ϕ(x)，使得Uϕ(x) = ϕ(T(x)) = lϕ(x) (2-20)10第二章 动力学系统与 Koopman 算符则称 l 为 Koopman 算符的ᵢᖷ,ٲϕ(x) 为 Koopman 算符的ᵢᖷ࠳ᮦ。
Koopman 算符的本征值和本征函数具有以下性质：
性䍞 1：若 ϕ1(x),ϕ2(x) 分别是 Koopman 算符 U 对应于 l 的本征函数，则 y(x) =aϕ1(x)+ bϕ2(x) 也是 U 的本征函数，对应本征值为 l:
)性䍞 2：若 ϕ1(x),ϕ2(x) 分别是 Koopman 算符 U 相应于本征值 l1,l2 的本征函数，则 y(x) = ϕ1(x)ϕ2(x) 也是 U 的本征函数，相应本征值为 l1l2:
-22)特别的，若 ϕ(x) 是 Koopman 算符 U 相应于本征值 l 的本征函数，则 ϕn(x) 也是U 的本征函数，相应的本征值为 ln:
23)本征函数 ϕ(x) 是一个在相空间上特殊的可观测函数，若将其在一组函数空间fg1(x);g2(x);··· ;gm(x)g 中表示ϕ(x) =m∑i=1aigi(x) (2-24)则 Koopman 算符描述本征函数 ϕ(x) 的演化规律可以用一组基函数的演化规律来描述：
在动力学系统中， Koopman 算符的本征值与本征函数有着特殊的含义。根据本征函数的定义，我们有其中 p 为时间因子，我们可以看到， Koopman 算符的本征函数值随着时间的演化呈 1=l 倍变化，这反映了一种特殊的函数演化规律，而这个特殊的函数就是我们的Koopman 算符的本征函数。相较于无规则的混沌演化，这种有规律的演化则更容易观察研究，而由于本征函数 ϕ(x) 的特殊性，其必然反映了某种相空间的性质。因此，探究 Koopman 算符的本征函数的意义就变得尤为重要。
特别的，当 l = 1 时，则本征函数 ϕ(xp) = ϕ(xp−1) = ··· = ϕ(x0)(p 2 Z 为时间指标)，此时本征函数不随时间发生变化，即 ϕ(x) = C（C 为常数），这与动力学系统中的守恒量相对应。例如在能量守恒定律中，就对应一个能量函数不随时间发生变化E(，亦可反推该函数是 Koopman 算符的本征函数。
当 jlj = 1 时（即 l = eiq） , 则本征函数 Z为时间指标), 此时本征函数的模不随时间发生变化 (而相位在发生变化)，这也对应了动力学系统中的一种守恒量。例如在匀速圆周运动中的速度矢量。
此外，在动力学系统中，周期轨道也反映了一种守恒量， Koopman 算符的本征函数也与周期轨道有着密切的联系。
对于一个复杂的动力学系统，我们往往难以刻画其整体的动力学演化规律，因为许多系统的相空间在不同区域有着不同的性质。但若我们能够将动力学系统的相空间划分为多个区域，而每个区域的动力学系统有着相似的规律，我们便可以按区域描述相空间的演化规律。而相空间的划分又有着多种角度，我们可以从不同的角度对相空间进行划分，从而更具体的描述相空间的演化规律。
Koopman 算符的本征值为我们提供了一个划分相空间的思路。对于 Koopman 算符谱中 jlj = 1 的本征值对应的本征函数，计算相空间中所有点的本征函数值，则本征函数值的模相同的点属于一个不变集。不变集中对应动力学系统的守恒量。若能通过这些不变集将相空间进行划分，我们便能实现对相空间运动模式的分块描述。
因此我们可以求得 Koopman 算符的本征函数，并通过 Koopman 算符的本征函数实现对相空间的划分。通过多个本征函数从不同角度对相空间的划分，我们便可以更具体的刻画相空间的性质。
2.3.4 Koopman 䉧᷆࠼ф࣑ࣞᆜ⁗ᕅ由于 Koopman 算符本征函数对相空间划分的重要性，我们将通过数值计算求得Koopman 算符的本征函数。Koopman 算符作用在函数上，描述了函数的演化规律。为了能够精确的描述一个本征函数，我们可以选取一组基函数 g1(x);g2(x);··· ;gm(x),x 2 R，12第二章 动力学系统与 Koopman 算符其张成了一个函数空间，对于在该函数空间的任意函数 f (x)，我们都可以表示为f (x) =m∑i=1aigi(x) (2-27)若我们能描述该函数空间内所有基函数的演化，则可以在该函数空间中求得我们的本征函数 ϕ(x)。
Ugi(x) = gi(T(x)) = g˜i(x) (2-28)为了得到 Koopman 算符的本征函数, 我们需要构造演化前与演化后的数据，通常采用构造数据矩阵的方式，设某 p 时刻的数据为 fxp1;xp2;··· ;xpng， xi 2 Rn，当时刻为 p + 1 时，数据演化为 fxp1+1;xp2+1;··· ;xpn+1g， xi 2 Rn，在选取的基函数gi(x),i = 1;2;··· ;m 下，利用已知数据点将 m 个基函数 (我们称之为” ࠳ᮦṲ⛯”) 及演化后的函数表示为在 fxp1;xp2;··· ;xpng(我们称之为“╊ौṲ⛯” ) 下的列向量，从而构成两个 n×m 的数据矩阵：
其中 K 我们称为演化前数据矩阵， L 称为演化后数据矩阵， K、 L 的每一列为相空间在一组点在某个基函数上的取值，当相空间的点数足够多时，可以视矩阵的每一列为一个基函数的离散数据表示， K、 L 则可以看作是多个基函数的组合，分别表示演化前的基函数和演化后的基函数，而演化后的基函数又可以看作一个新的函数，视为 Koopman 算符作用在基函数上得到。于是 K、 L 之间的关系可由 Koopman 算符表示UK = L (2-31)13Koopman 算符的矩阵表示可由上式确定，因此我们可以通过上式求得 Koopman 算符的矩阵表示，进一步求得 Koopman 算符的本征值与本征函数。
在构造矩阵 K 与 L 时，我们需要选定一组基函数 gi(x);i = 1;2;··· ;m，基函数的选取对我们计算本征函数的结果至关重要，于是我们将从多个角度讨论基函数的选取对本征函数的影响。基函数的选取至关重要，为了能较好的表示出 Koopman 算符的本征函数，需要一组较完备的基函数作为算符作用的可观测量，可以选取 Gauss 基函数、 Fourier 基函数、 Legendre 基函数。然而上述基函数只有在数量趋于无穷时才具有完备性，我们希望基函数的数量足够多，然而为了相空间的数据点能够较好的表示每个基函数，基函数的数量又不宜超过演化格点的数量，此外考虑到计算量的因素，我们只能将基函数的数量设为某个有限值。此外由于相空间粒子分布的不均匀性，我们还可以取不同分布的基函数。总之，基函数的选取有多重形式，而基函数的选取会影响到本征函数的计算，因此基函数的选取至关重要。
在选取合适的基函数与构造数据矩阵 K 与 L 后，我们即可以根据 UK = L 计算求得 Koopman 算符的矩阵表示以及本征值与本征函数，通常我们会得到 n 个本征值与本征函数，而在这些本征值中，我们比较关心的是本征值 (或者本征值的模) 接近1 的本征函数，因为本征值为 1 的本征函数反映了相空间中一条随时间演化不变的轨道，这种轨道即是系统的一个关键特征，而由于我们的数值计算误差，因此我们将选取接近 1 的本征值对应的本征函数。
Koopman 算符对相空间的划分可以通过混沌系统的已知特性来得到验证，如在Logistic 映射中有两个不动点，而我们得到的本征函数图像恰好在不动点以及不动点的原像处得到了本征函数的极值点，说明了本征函数能够体现系统的动力学特征；
此外，我们还可以通过验证动力学系统的周期点与周期轨道等特征，对比 Koopman算符的本征函数，以此观察 Koopman 算符分析动力学系统的可行性。
Koopman 算符理论上能够区分相空间的不同区域的性质，对于具有噪声的数据和涨落的演化规律， Koopman 算符同样可以通过控制函数空间的精细度来对相空间进行粗细粒度的划分，因此 Koopman 算符具有鲁棒性：即使我们的演化有噪声的影响，如探究噪声中常见的高斯白噪声，我们同样可以对相空间进行粗粒度的划分。这在我们探究动力学系统中的演化规律中尤为重要。
14第二章 动力学系统与 Koopman 算符2.3.5 Koopman ㇍ㅜ的࠳ᮦグ䰪2.3.5.1 正交完备基函数簇在 2.3.4 节的讨论中，我们要选择一组基函数 gi(x);i = 1;2;··· ;m 来构造数据矩阵 K 与 L，这里的基函数即限定了我们的函数空间，我们的本征函数由这组基函数来描述，因此，如何选择合适的基函数成为了一个至关重要的问题。
为了较好的表示出 Koopman 算符的本征函数，我们通常应选取一组正交完备的基函数来描述本征函数。完备性使得在此函数空间的任意函数都能且仅能得到一组唯一的线性组合。正交性使得基函数之间互不依赖。一般的，我们将定义在区间[a;b] 上的一组基函数 gi(x) 的正交归一性用以下函数的内积来表示：
1; (i = j)0; (i ̸= j)(2-32)举一些基函数的例子。对于一维系统，设相空间为 x 2 [0;1]，我们在这个相空间范围内选取一组基函数 gi(x);i = 1;2;··· ;m。考虑到正交性，对于最简单的一个例子就是矩形窗基函数：
gi(x) =8][]:
pm; (i − 1m⩽ x [i m)0; x; i = 1;2;··· ;m (2-33)矩形窗基函数是一个局域化的函数，其结构足够简单，其所描述的函数空间总是能按照本征函数值区分相空间。
矩形窗基函数的每个函数之间没有任何冗余信息，这样很多函数都没有起到描述相空间的作用，为此我们可以将函数取为一组近似局域化的高斯基函数：
gi(x) = Cexp(−(x 2−dx2ji)2 ); xi = mi − 21m; i = 1;2;··· ;m (2-34)其中 C 为高斯函数的归一化常数 C = pp1ps 。高斯基函数满足近似正交性，是一组近似局域性的全局基函数，每个函数都定义在整个相空间上，其形状类似一“波包”。其中有两个参数：波包中心 xi 和波包宽度 dj。波包中心 xi 表示高斯波包的中心位置，其选取通常应遍布大部分相空间，为了减少边界效应，一般情况下我们选取 xi = mi − 21m；波包宽度 dj 描述高斯波包衰减到 √1e 的距离，其选取应综合考虑相15images/function_basis.png图 2-2 矩形窗、高斯、傅里叶、勒让德基函数图像空间粒子的一步演化距离和函数之间的重叠，一般情况下我们选取 dj = 21m。计算表明，使用高斯基函数可以得到较为清晰的动力学系统的相空间划分。
除了上述两个局域化的基函数，我们还可以考虑非局域化的基函数。如定义在x 2 [0;1] 上的傅里叶基函数gk(x) = eik(2p)x; k = −m;−(m − 1);··· ;m − 1;m (2-35)傅里叶基函数描述了每个频率的重要程度。再如多项式基函数gi(x) = xi; i = 0;1;··· ;m (2-36)和其处于同一函数空间的定义在 x 2 [−1;1] 上的勒让德基函数gi(x) = √2k2+1Pi(x); k = 0;1;··· ;m (2-37)下图绘制了一维矩形窗基函数、高斯基函数、傅里叶基函数和勒让德基函数的图像对于高维系统，亦可以将上述方程扩展，如高维傅里叶基函数与高维高斯基函数。对于任意 n 位动力学系统，我们总是可以构造一组 n 维函数空间，将本征函数在此 n 维函数空间描述，我们便可以更准确的描述本征函数，从而对我们的相空间16第二章 动力学系统与 Koopman 算符进行划分。
2.3.5.2 自然演化的函数空间在 2.3.4 节中，我们在动力学系统中可以选取一组合适的基函数，并将本征函数在此基函数中进行描述。这里考虑另一种取基函数的方法：自然演化的函数空间。
对于在相空间 p 中的系统状态变量 xi，我们取一个初始状态 xi，并将其进行 n 次演化，得到一组随时间演化的状态变量 (xi;xi+1;··· ;xn+i−1)T，这组状态变量也可以看做是相空间的一个 n 维函数，只不过其是由自然演化得到的。对于这样的一个基函数gi(x) = (xi;xi+1;··· ;xn+i−1)T，我们将 Koopman 算符作用在 g1(x) 上可以得到Ugi(x) = U(xi;xi+1;··· ;xn+i−1)T = (xi+1;xi+2;··· ;xn+i)T = gi+1(x) (2-38)我们连续的取 m 个这样的自然演化的基函数 gi(x) = (xi;xi+1;··· ;xn+i−1)T，并利用自然演化的基函数构造数据矩阵 K 和 L:
、K、 L 的每一列为相空间在一个初始点上的演化，当演化次数 n 足够多时，我们可以用这组演化来表示一个描述相空间的自然函数， K、 L 可以看作是多个基函数的组合，分别表示演化前和演化后的自然函数。同样的，数据矩阵 K、 L 之间的关系可由Koopman 算符表示UK = L (2-41)不同于 2.3.4 节中我们构造的函数空间，自然演化的函数空间仅由系统的动力学演化得到，其更能反映动力学系统的本征行为。我们可进一步求出在自然演化的基函数中 Koopman 算符的本征函数并以此来划分相空间。
172.4 Koopman ㇍ㅜѣ的࣑ࣞᆜ2.4.1 ㅜਭ࣑ࣞᆜфć䗯⮂⛯Ĉ符号动力学起源于动力系统的抽象拓扑理论的研究，并从 20 世纪 60 年代起逐渐在应用于一维映射的研究过程中得到发展和完善。符号动力学是研究符号动力系统的学科，这种系统的状态均可表示为有限个符号的无穷序列，而由任一状态点引出的运动轨道可由表示该状态的无穷序列通过简单的移位规则来确定。许多复杂动态系统均可经过变换等价于这类系统，从而可通过对比较简单的符号动力系统的分析来研究一般动力系统的行为。这种方法特别在混沌等复杂行为研究中占有重要地位。符号动力系统在其他领域也有广泛的应用。例如研究离散事件动态系统控制问题的代数方法就与符号动力学有密切的联系。
符号动力学是实际动力系统的抽象和概括。对于一个相空间的离散动力学系统，我们可以依据不同的符号将相空间的不同区域命名，如使用符号“0”和符号“1”来讲相空间划分为两个区域。通过相空间的演化，又可以继续用有限个符号来更加细致的划分相空间。理论上相空间中的每个点都可以用一个无穷的符号序列与之对应。
当传统的微分理论难以对动力学系统分析时，我们可以使用粗粒度的符号动力学来研究动力学系统的性质。即使一般的数值方法行不通，符号动力学仍可以对系统进行定性分析。
Logistic 映射就是一个可用符号动力学很好描述的典型， Logistic 映射的动力学方程xn+1 = f(xn) = gxn(1−xn);xn[0;1]; n = 1;2;3;··· (2-42)这里我们取 g = 4,Logistic 映射的迭代过程使它成为一个经典的混沌系统，符号动力系统也被视为混沌系统的原型，进而还可将符号动力系统的运动特征作为混沌的描述并成为混沌的一种严格的数学定义。 Logistic 映射的相图与符号动力学的划分可由下图表示： Logistic 映射的动力学过程可以看作是在一维相空间上的拉伸再折叠的过程，在折叠的临界点处 x = 1 2 我们将其作为一个“临界点”，在临界点的两边我们分别标记区域为“0”和”1”。而在”0” 区域的相空间 x 2 [0; 1 2] 中，其下一步演化的位置即存在演化为”0” 的点，也存在演化为”1” 的点。这样，我们可以根据该区域一次演化的结果进行更进一步的划分，则“0”区域的相空间又可以划分为”00” 和”01” 的相空间；同理，“1”区域的相空间可以划分为”11” 和”10” 的相空间。若将二次演化乃至多次演化作为划分符号动力学相空间的评判标准，则我们可以用符号动力学标记18第二章 动力学系统与 Koopman 算符images/logistic_symbolic.png图 2-3 Logistic 映射的符号动力学划分任意精度的相空间区域。特别的，在极限情况下，当我们演化的次数足够多时，我们可以对相空间的每个足够小的区域都划分出来，即相空间的每个点都对应一组无穷符号序列。
在符号动力学中，一个最关键的问题就是如何寻找“边界点” ,边界点是指在符号动力学中可以划分相空间不同区域的临界点，如在 Logistic 映射中， x = 1 2 就是一个“边界点” , 根据其演化我们还可以找到一次演化的边界点 x = 1 2 ± p42，以此类推。
所以，若能找到系统的“边界点”，便可以通过符号动力学对其相空间进行划分。
Koopman 算符的本征函数能够划分相空间区域的不同性质，而符号动力学的边界点也是反映了相空间区域的划分。当相空间的性质足够简单时，我们对其划分的标准就更单一。于是我们可以认为，此时 Koopman 算符的本征函数对相空间的划分恰好就是反映了符号动力学中的“边界点”对相空间的划分。我们将在后面的例子中继续探究这两者之间的对应关系。 Koopman 算符的本征函数恰能反映符号动力学的“边界点”，这也为我们寻找符号动力学的“边界点”提供了一个有效的方法。
2.4.2 ࣑ࣞᆜ㌱㔕的㓵性ौф⍷ශ对于一个线性一维连续时间动力学系统x˙ = lx (2-43)19其有一个不动点 x = 0。我们很容易求得其解为x(t) = Celt (C 为任意常数) (2-44)当 l [ 0 时，系统在不动点 x = 0 邻域的长期行为向不动点处逼近，此时的不动点为どᇐ的；当 l [ 0 时，系统在不动点 x = 0 邻域的长期行为逐渐远离不动点，此时的不动点为уどᇐ的。
当动力学系统为高维时，不动点的稳定性变得复杂起来，我们首先考虑一个线性 n 维连续时间动力学系统x˙ = Ax (2-45)其中 x 为 n 维状态变量，该系统的不动点为 x = 0。一般的，当 A 具有 n 个线性无关的本征向量时，通过计算可以得到该线性常微分方程组的解为x(t) =n∑i=1Cielitvi (2-46)其中 Ci 为积分常量， li 与 vi 为矩阵 A 对应的本征向量与本征函数。
在二维情况下，对于线性动力学系统x˙ = ax+byy˙ = cx+dy(2-47)我们可以求出A = 0 @a b c d1 A (2-48)对应的本征值 l1 和 l2 及其对应的本征向量 v1 和 v2，则该二维系统的通解为x(t) = C1el1tv1 +C2el2tv2 (2-49)这个结果意味着在相空间中，不动点 x = (0;0) 的邻域处有两个本征方向，两个本征方向的长期行为取决于 l1 与 l2 的值：当 l [ 0 时，该本征方向的长期行为逐渐靠近不动点，此时该本征方向为稳定的；当 l ] 0 时，该本征方向的长期行为逐渐远离不动点，此时该本征方向为不稳定的。当两个方向上的长期行为都逐渐趋于不动点时，我们可以证明，不动点邻域的长期行为都趋于不动点，此时我们称该不动点为稳定20第二章 动力学系统与 Koopman 算符的。除此之前，我们在非线性动力学中还根据本征值将不动点分为结点、焦点、鞍点和中心等等。
对于非线性动力学系统，其方程的解析解不易求出，我们很难讨论其每个点的长期行为，但我们可以利用不动点邻域的线性化理论对不动点附近的动力学作定性的分析。考虑一个一般的二维非线性动力学系统x˙ = f(x;y)x˙ = g(x;y)(2-50)设 (x∗;y∗) 为一个不动点，则f(x∗;y∗) = 0g(x∗;y∗) = 0(2-51)设在不动点 (x∗;y∗) 附近处有一点 (x;y)，令x = x∗ +uy = y∗ +v(2-52)其中 u 和 v 表示不动点附近的扰动量，为了了解这一扰动量是增加还是减少，我们观察 u 和 v 的微分方程(2-56)为在不动点 (x∗;y∗) 处的 Jacobian 矩阵。 Andronov 等（1973）证明了：如果 Jacobian矩阵 A 的本征值与本征向量认为不动点是鞍点、结点或者焦点，那么对于原有的非线性系统方程来讲，该不动点也是一个鞍点、结点或者焦点（即边界情形：中心、退化结点、星形结点或非孤立不动点会随二次项的变化而变化）。于是我们可以将扰动量的动力学方程的二次项忽略掉，得到如下的系统方程：
0@˙u ˙v1A=0BB@¶ f¶x¶ f¶y¶g¶x¶g¶y1CCA(x∗;y∗)0@u v1A(2-57)这样，对于非线性系统，我们也可以对不动点邻域的动力学特性进行分析，从而得到不动点附近演化的长期行为。
对于离散映射系统，我们也可以得到类似的结论，但是 Jacobian 矩阵的判别关系要作相应的调整：当 jlj [ 1 时，系统在不动点邻域的长期行为逐渐接近不动点；
当 jlj ] 1 时，统在不动点邻域的长期行为逐渐远离不动点。
Koopman 算符的本征函数能够划分相空间区域的不同性质，而不动点作为相空间一个重要的分界点，其邻域的线性化及其动力学行为会影响其周围相空间的动力学特性，在不动点周围的相空间区域性质也会随线性化的本征方向和本征值而有所改变。因此 Koopman 算符对相空间的划分会反映出不动点及其线性化的结果。我们也将在后面的例子中继续讨论这两者的对应关系。
2.4.3 ઞᵕ䖞䚉我们将连续时间系统中满足 x(t +T) = x(t) 和离散映射系统中满足 xn+T = xn 的轨道称为ઞᵕ䖞䚉，且周期为 T。关于求映射系统中的周期轨道有很多理论，如庞加莱截面（Poincaré plain）法、线段迭代交点法、牛顿拉夫申（Newton-Raphon）法、多点打靶（Multipoint Shooting）法，我们这里以牛顿拉夫申法和 Multipoint Shooting方法为例，介绍求解映射系统周期轨道的方法。
22第二章 动力学系统与 Koopman 算符设有一存在周期解 (x;T) 的动力学系统满足f t+T (x) = f t(x) (2-58)为了求解该动力学系统的周期轨道，我们通常的做法是从某个近似解出发，不断的修正这个解，直至满足某种精度为止。设动力学系统的周期解为 x∗，定义函数F(x) = f t+T (x) − f t(x) (2-59)其周期解满足 F(x∗) = 0，通过对函数 F(x) 在初始值 x0 的线性化得F(x) ≈ F(x0)+ F′(x0)(x − x0) (2-60)则 F(x) = 0 的近似解为x ≈ x0 −F(x0)F′(x0) (2-61)然后将初始值 x0 改变为 x0 + d(其中 d = x − x0) 继续运算，迭代并重复此过程。我们可以证明此迭代的过程是局部二阶收敛的，即不断趋于周期解。当我们得到的一系列收敛的 d 值满足所要求的精度 jdj ⩽ e 时，此时的近似解 x 即为系统的周期解 x∗。
由于迭代的过程是局部收敛的，当周期 n 的值比较大时，混沌系统的轨迹指数分离特性，其迭代值偏离周期点很大，会远离其收敛于而导致迭代发散， MultipointShooting 方法在此基础上截取周期段，同时增加预测点，使偏离程度变小，从而使周期解的收敛速度得到改善。
对于一个一维映射系统xn+1 = f (xn) (2-62)设其有周期解 n，任意选取一个初始值 x0，迭代映射 n 次得到一系列迭代值(x1;x2;··· ;xn)0，上标 0 表示该一系列值为初始值，我们将在后续计算中不断更新这一系列值。定义 n 维向量 F(x) 如下：作为该 n 维向量 F(x) 的初始值，迭代一次后该序列值将表示为(x1;x2;··· ;xn)1，根据牛顿拉夫申法，我们可以得到
解 (2-66) 式可以得到 d 的数值解，即由初始值 (x1;x2;··· ;xn)0 迭代为 (x1;x2;··· ;xn)1，继续重复上述过程，可以得到一系列收敛的 d，当 d 满足我们的精度要求 jdj ⩽ e 时，我们即得到系统的周期解 
高维周期轨道的计算可以通过一维情况进行拓展，如在二维映射系统中xn+1 = f (xn;yn)yn+1 = g(xn;yn)(2-67)24第二章 动力学系统与 Koopman 算符我们可以将 (2-66) 式改写为0· −¶g(xn;yn)¶x −¶g(xn;yn)在离散映射系统中，设有一周期为 T 的动力学系统 xn+T = f T (xn) = xn，若定义一个新的映射 F = f T，则对于新的映射 F，我们有 F(xn) = xn, 即 xn 为新映射系统的不动点。 Koopman 算符对相空间区域不同性质的划分也应在 F 映射系统中有所体现，而新映射 F 与原映射 f 之间为 T 次映射，在相空间可表示为 T 次重复变换过程（包括拉伸、反转、折叠等），因此，我们对相空间区域的划分也会由于周期轨道的不同而有所体现。
25第三章 典型混沌系统的 Koopman 分析ㅢпㄖ ޮශ␭⋂㌱㔕的 Koopman ᷆࠼在上一章中，我们介绍了动力学系统的概念与 Koopman 算符对动力学系统相空间的划分，本章将据此分析一些典型的混沌系统并使用 Koopman 算符对其相空间进行划分。
我们分析了一维离散映射系统 Tent 映射、 Logistic 映射，二维离散映射系统Hénon 映射，三维连续时间系统 Lorenz 系统。在仅利用这些系统演化的离散的数据，使用 Koopman 算符能够较好的区分出不同动力学系统中不同性质的相空间区域。
3.1 ж㔪⿱ᮙ᱖ሺ㌱㔕φᑆ㈭᱖ሺ帐篷映射 (Tent Map)，是一个一维分段的线性映射，因其函数图像类似帐篷而得名。其广泛运用在混沌加密系统中，并且在混沌扩频码的产生、混沌加密系统构造和混沌优选算法的实现中也经常被使用。
3.1.1 ᑆ㈭᱖ሺ的࣑ࣞᆜ帐篷映射是定义在 x 2 [0;1] 上的一维离散映射：
帐篷映射存在两个不动点:x1∗ = 0 和 x2∗ = 2 3。帐篷映射在其参数范围内是一个混沌映射，并且具有均匀的分布函数和良好的相关性。帐篷映射的相图 (图 3-1) 描述了相空间的映射关系。 xn ! xn+1：
帐篷映射的动力学过程可以看作是在相空间 (0;1) 上的点拉伸再折叠的过程, 如图 3-2，帐篷映射可以看作两次映射的复合，第一次映射将 AB 区间上的点拉伸为A′B′, 相空间从 (0;1) 拉伸到 (0;2), 点 0、 0:5、 1 分别映射为 0、 1、 2；第二次映射将27images/tent_phase.png图 3-1 帐篷映射的相图 (a = 1 2)images/tent/tent_dynamic.png图 3-2 帐篷映射的映射过程A′B′ 区间上的点拉伸为 A′′B′′，相空间从 (0;2) 压缩到 (0;1), 点 0、 1、 2 分别映射为 0、1、 0。两次映射的拉伸与折叠过程完成了相空间 (0;1) 到其自身的映射。在该过程中，存在一些关键的“转折点”，如第一次映射的 x = 0:5 与第二次映射的 x = 1，且相空间的性质随这些点呈对称分布。
3.1.2 ᑆ㈭᱖ሺ的 Koopman ㇍ㅜᵢᖷ࠳ᮦ在上一章中的介绍中，我们探究了 Koopman 算符的本征函数与动力学系统的特征，帐篷映射作为一个较简单的一维分段线性映射，其动力学特征也容易探究，我们将以帐篷映射为例探究 Koopman 算符的本征值与本征函数与动力学特征的关系及对相空间的划分。
四种基函数下帐篷映射的本征函数 (m = 4)3.1.2.1 正交完备基函数空间在式 (2-31) 中，我们得到了 Koopman 算符的矩阵表示，选取一定参数：演化格点数量 n = 1000，函数格点数量即基函数数量 m = 4，依此我们可以计算矩阵 U 的本征值与本征函数。通常我们会得到许多本征值与本征函数，且本征值与本征函数的数量取决于函数格点的数量。而我们在上一章中提到了，关于本征值与本征函数，我们更关心接近 1 的本征值与对应的本征函数，因为其反映了相空间中一条随时间演化不变的轨道。我们可以将本征函数值的大小 (若非特殊说明，当本征函数为复数时我们取其实部作为大小) 画在相空间中，通过将本征函数与相空间对应来探究其关系。
图 3-3 画出了 n = 1000,m = 4 时，四种不同的基函数下 (矩形窗局函数、高斯基函数、傅里叶基函数、勒让德基函数）帐篷映射的本征函数，其中每个基函数下又包含 4 个不同的本征值对应的本征函数。四种基函数的分布见图 2-2。从图 3-3 中我们可以发现，在不同的基函数下， Koopman 算符的本征函数表现出极大的差异，这也可以从本征函数与基函数之间的关系中可以得出：本征函数总是在选取的基函数29空间内，即从数学上每个本征函数都由所有的基函数线性组合而成。图中取 m = 4时，其函数空间是相当不完备的，只能表示很有限的函数，因此我们的本征函数只是在此函数空间上的一个近似 (或者说是函数几何空间从高维到低维的投影)，因此基函数的选取会影响本征函数空间，因此我们对基函数的选取亦至关重要。为了能更好的划分出相空间，我们应尽量体现出不同基函数的作用，以此对相空间进行划分，如矩形窗基函数、高斯基函数同属局部 (或近似局部) 函数，这种局部函数能通过每个基函数比例系数的大小来体现对相空间的划分，因此我们更关心这种局部函数，在后面的计算中也会更多的使用高斯基，以此来体现本征函数对相空间的划分。
在图 3-3 中，每个子图中都包含 4 个不同的本征值及其对应的 4 个本征函数图像，且其中包含一个 l ≈ 1 的本征值，在之前的讨论中，我们认为本征值接近 1 的本征函数反映了相空间中一条随时间演化不变的轨道。而我们在矩形窗基函数和傅里叶基函数中也确实看到了这样的常函数轨道。而其他的本征值则不趋于 1，这也可以从我们对函数空间选取的不够完备去考虑：我们不可能选取一个完全完备的函数空间，我们的本征函数只是在此函数空间的一个近似。
基函数数量的不同同样也是影响本征函数的一个重要因素。图 3-3 中画出了m = 4 时的本征函数，当 m 取不同值时，如 m 越来越大时，意味着我们的函数空间的维度更高，可以描述的本征函数的维度也就越高，则对于局部函数如高斯函数而言，我们描述本征函数的精细度就更高，于是我们可以提高基函数数量 m 的大小，用以描述更精细的本征函数。但这也会使我们得到的本征函数的数量有所增加，当我们将关心的本征函数聚焦为 l ≈ 1 时，我们可以将不同基函数数量的本征函数画出，如图 3-4 中，我们取四种基函数及基函数数量 m = 2;3;4;8;10;16;20;50;100 时对应的本征值与本征函数，以此来反映出随着函数空间的精细度的提高本征函数的变化。
在图 3-4 中，我们确实可以发现，当基函数数量增加时，本征函数图像的频率增加了，即描述本征函数的精细度增加了。且本征函数的变化有一定的规律：如在高斯基函数中，当 m = 2 时，函数有一个近似 x = 0:5 的极值点，而此极值点在其他 m 值时一直存在，同样 m = 3 多出的两个极值点似乎也并未随着 m 值的增加而消失，这似乎印证了随着基函数数量的增加而使得描述本征函数的精细度的增加。
从另一个角度， x = 1 2 点似乎具有某种特殊性，其将相空间 (0;1) 分为对称的两部分，而每部分中又有极值点将每个部分各自分为两部分，形成类似分形的本征函数，我们将在后续的讨论中继续探究这些点与本征函数的关系。
勒让德基函数图 3-4 不同基函数数量下帐篷映射的本征函数3.1.2.2 自然基函数空间在式 (2-41) 中，我们通过构造自然基函数格点得到了 Koopman 算符的矩阵表示，选取合适的参数：演化格点 n = 1000，基函数数量 m = 4 下, 我们可以计算得到 4 个Koopman 算符 U 的本征值与本征函数并将其画到相空间中，如图 3-5。我们可以发现在自然基函数空间下，本征函数的图像变得更为尖锐，但也更接近帐篷映射的相图。且其同样存在一些 x = 1 2; 1 4; 3 4 的关键点。
当我们取不同的基函数数量 m = 1;2;3;4;5;6;7;8;9 且取 l ≈ 1 的本征函数，我们可以得到图 3-6。从图中我们可以发现，基函数数量每增加 1，极值点出现的个数近似增加两倍。而我们又考虑到帐篷映射 T 及其多次映射 T n 的关系：映射次数 n 每增加一次， T n 的相图变多增加一次弯折，即极值点的数量增加一倍。这与我们看到的本征函数图像的极值点较为相似。
无论是在正交完备基函数族还是在自然基函数中，我们都发现了在本征函数中的一些特殊的极值点，及不同基函数下本征函数之间的关系，我们将在后续的讨论中这些极值点。
31images/tent/Tent_eigen_natural_n1000_m4.png图 3-5 自然基函数下帐篷映射的本征函数 (m = 4)images/tent/Tent_eigen_natural_n5000_m1-2-3-4-5-6-7-8-9.png图 3-6 不同基函数数量下帐篷映射的本征函数32第三章 典型混沌系统的 Koopman 分析迭代次数 边界点 (x = 0)11表 3-1 帐篷映射的边界点 (x = 0): 经过多少次迭代可以到达不动点 x = 0，下划线的点是每层次的新增点images/tent/Tent_boundarys_x0.png图 3-7 帐篷映射的边界点 (x = 0): 相同大小和颜色的点同属于一个层次3.1.3 Koopman ㇍ㅜሯᑆ㈭᱖ሺ的⴮グ䰪࠼ࡈ在观察帐篷映射 Kooopman 算符的本征函数中我们可以发现，本征函数图像中存在一些特殊的极值点，且这些点出现的位置与我们的帐篷映射的相图有些极为相似的关系：帐篷映射中 x = 12 处为映射的极值点，而 x = 1 4; 3 4 映射一次恰到到达 x = 1 2处。我们考虑这些点与不动点的关系：帐篷映射存在两个不动点 x = 0 和 x = 23，点x = 12 经过两次映射可以到达不动点 x = 0。我们可以将经过有限次迭代可以到达不动点处的点称之为帐篷映射的䗯⮂⛯，从动力学演化的角度称之为不动点的৕。⛯܅我们猜测， Koopman 算符的本征函数恰好就反映了这些边界点。
我们计算得到不动点 x = 0 的一系列原像点，如表 3-1。将其按照ቸ⅗（经过多少次演化才达到不动点）作出图像，如图 3-7。
同样，对于另一个不动点 x = 2 3，我们同样作出其一系列原像点 (表 3-2)，且按层次绘制其在相空间的位置 (图 3-8)。
观察这些边界点的位置，对比我们之前观察到本征函数的极值点，更加印证了我们之前的猜想： Koopman 算符的本征函数反映了边界点的划分。为了证实我们的猜测，我们将本征函数和边界点的位置进行对比观察：在图 3-9 中，我们取不同的基函数数量 m = 2;3;4;5;8;10;15;20, 并绘制最多 9 个本征函数图像，将本征函数图像的极值点标出，并将帐篷映射的边界点同时标出，以此来对比二者之间的关系。
33迭代次数 边界点 (x = 2 3)0 0.66661 0.3333,0.66662 0.1666,0.3333,0.6666,0.83333 0.0833,0.1666,0.3333,0.4166,0.5833,0.6666,0.8333,0.916640.04166,0.0833,0.1666,0.2083,0.2916,0.3333,0.4166,0.4583,0.5416,0.5833,0.6666,0.7083,0.7916,0.8333,0.9166,0.9583表 3-2 帐篷映射的边界点 (x = 2 3): 经过多少次迭代可以到达不动点 x = 23，下划线的点是每层次的新增点images/tent/Tent_boundarys_x2-3.png图 3-8 帐篷映射的边界点 (x = 2 3): 相同大小和颜色的点同属于一个层次我们观察本征函数的极值点与帐篷映射的边界点，在图 3-9(a) 的第二个小图中，我们观察到基函数 m = 2 时本征函数存在一个极值点，其与边界点 x = 12 是比较吻合的。在图 3-9(b) 中，基函数数量 m = 3，由于高斯基函数格点数量有限，其不可能在x = 14;
34处有极值点，但观察图像我们发现其在这些点的附近出现了极值点。随着基函数数量的增加 m = 4;5;8;10 时， x = 1 4; 34 处附近的极值点越来越逼近这两个边界点，当 m = 15 时， x = 14;
34处附近各存在一个极值点；当 m = 20 时，极值点与边界点吻合的较好。
我们可以得出初步结论： Koopman 算符的本征函数的极值点确实反映了帐篷映射的边界点，且随着本征函数基函数数量的增加，函数格点的增加使本征函数的精细度增加，从而能更精确的刻画帐篷映射的边界点。这些边界点即对应着我们对相空间的划分：我们可以依本征函数的极值点对相空间区域进行划分。在上一章的讨论中我们了解到，这些帐篷映射的边界点其实就是符号动力学的分界点，这为我们提供了一种寻找符号动力学分界点的方法： Koopman 算符的本征函数极值点可以反映符号动力学的分界点，若其能成为一个普遍的规律，当我们面对一个较复杂的系统时，我们可以通过 Koopman 算符的本征函数寻找其极值点，来寻找该系统对应的符号动力学的分界点。且随着我们增加基函数的数量，我们便能更精细的刻画符号动力学的分界点。从而使我们对该动力学的特征能够有着粗粒度的认识。
3-9 帐篷映射的边界点与本征函数: 每个图中红色的点为 x = 0 系列的边界点，绿色的点为x = 23 系列的边界点 (不区分层次)，且本征函数的极值点用空心方块标出35images/tent/noise/Tent_noise_phase_d0.png(a) noise=0images/tent/noise/Tent_noise_phase_d0-001.png(b) noise=0.001images/tent/noise/Tent_noise_pha(c) noise=0.01图 3-10 帐篷映射不同噪声下的相空间:noise 表示噪声与函数幅值之比3.1.4 ᴪཐ的䇞论我们有了初步的结论： Koopman 算符的本征函数的极值点反映了帐篷映射的边界点。然而我们需要对这个结论作进一步的探究，我们可以提出以下三个问题：
• 这个结论是否具有鲁棒性？
• 这种方法寻找到的边界点准确吗？若不够精确如何提高精确度？
• 这种寻找边界点的方法适用于其他系统吗？
我们将针对以上三个问题，进一步讨论 Koopman 算符的本征函数及其对帐篷映射边界点的划分。
3.1.4.1 噪声对 Koopman 算符的影响在现实系统中，动力学系统的演化都会受到涨落的影响，即每次的演化都会有一定的浮动，若 Koopman 算符不具有鲁棒性，则为寻找边界点带来了一定的困难，为此我们假设我们的涨落符合高斯白噪声分布，将帐篷映射加入噪声项：
xn+1 = f(xn) = 1−2jxn − 12j+x (3-3)其中高斯分布的方差作为信噪比的参数可供调节，帐篷映射在不同噪声大小下的相图如图 3-10 所示。若 Koopman 算符对边界点的划分具有鲁棒性，则在此噪声影响下， Koopman 算符对边界点的划分应与之前相差无几。
我们取帐篷映射在 noise = 0:001 与 noise = 0:01 时 Koopman 算符对应的本征函数，如图 3-11 与图 3-12。同样我们在图中标出本征函数极值点的位置，及帐篷映射边界点的位置，对比图 3-9 来探究 Koopman 算符对边界点划分的鲁棒性。同时，我们在计算 Koopman 算符的矩阵表示时每次从 K 到 L 进行了多次的演化，并取演化的36第三章 典型混沌系统的 Koopman 分析平均值，即由于涨落的影响，我们每次的演化变为了一个高斯波包的分布，这样可以减少噪声对本征函数图像图像的随机性。
在图 3-11(a) 第二个小图中，我们观察到由于噪声项的影响， Koopman 算符的本征函数的极值点与边界点会有一定距离的偏移，随着基函数数量的增加，本征函数的细节上会有些许变化，但是大致趋势并未发生明显的变化。如图 3-11(h) 第七个小图中，本征函数在 x = 12 处的极值点与边界点发生了稍稍的偏离，但是总体观察其他的几个小图，还是能较好的反映帐篷映射的边界点。图 3-12 中增加了噪声的大小noise = 0:01，本征函数图像变得更不规则了，但总体观察 Koopman 算符本征函数的极值点，其噪声对其划分边界点的影响并不大。如在图 3-12(h) 第一个小图中，本征函数的细节变的稍稍不规则，但是在边界点 x = 1 2 附近处同样存在较明显的本征函数极值点。
综上我们可以确定， Koopman 算符的本征函数的极值点反映了帐篷映射的边界点这一结论是具有鲁棒性的。
3.1.4.2 寻找更精确的边界点我们已经初步探究了 Koopman 算符的本征函数的极值点反映了帐篷映射的边界点，并且提出可以通过 Koopman 算符的极值点来确定边界点，但是其精确性则有待进一步讨论，因为数值计算总会有一定的误差，能否在给定误差范围内寻找到我们所需要的边界点变得尤为重要。
在之前的探究中，我们发现随着基函数数量的增加，本征函数对边界点的刻画更为精细：函数格点数量越多，本征函数描述的边界点的层次与精细度随之增加，为了验证我们的这个结论，我们进行如下对比：当基函数数量增加一倍时，探究本征函数的极值点之间的关系。由于不同基函数数量下的本征值较多，我们需要选取合适的本征函数，为此我们需要寻找不同基函数数量下反映同样动力学特征的本征函数，我们可以利用互相关函数来定义本征函数之间的相似性（为了刻画不同基函数之间的关系，我们可以考虑这样一个问题，对于两个基函数数量 m1 和 m2，若我们已知 m1 下的本征函数，能够通过本征函数的定义来得到 m2下的本征函数？这转化为一个求函数最小值对应的参数问题，用数学公式描述为式37帐篷映射的边界点与本征函数 (noise = 0:001)38帐篷映射本征函数不同基函数数量之间的对应关系 (n = 1000): 根据较小基函数数量的本征函数 (蓝色) 寻找满足条件的较大基函数数量的本征函数 (其中第一项为满足本征函数的条件项，第二项为满足具有相关性的对应 m1 和 m2 的本征函数。且第二项的系数应远小于第一项 (满足本征函数定义为主，满足相关系为辅)，同时我们应有约束 jjϕm2jj = 1。在此条件下，我们探究不同基函数数量下本征函数之间的关系。
在图 3-13 中，我们根据寻找函数式 3-5 最小值进行了四组对比： m = 8;16,m =16;32,m = 32;64,m = 64;128, 在每个图中，蓝色的线表示较小的基函数数量下的本征函数，我们以此蓝色的本征函数 ϕm1 为基础，根据式 3-5 计算得到较大的基函数数量下的本征函数，即红色的本征函数 ϕm2。
在图 3-13(b) 第一个小图中，我们发现两个本征函数的分布几乎相同，这是由于我们在计算函数最小值时第二项的因素造成的，但在图 3-13(b) 第二个小图中，随着40第三章 典型混沌系统的 Koopman 分析基函数数量扩大一倍，本征函数的极值点的数量也增加了一倍左右，且红色本征值的极值点并未丢失蓝色本征值的极值点，且红色本征值的极值点较蓝色本征值点增加了一些点，通过数据上的验证，我们发现这些多出来的极值点恰好处于某一层次下的帐篷映射的边界点。这说明了随着基函数数量的增加，本征函数描述边界点的层次有所增加，这使得我们扩充了之前的结论： Koopman 算符的本征函数的极值点反映了帐篷映射的边界点，且随着函数格点数量的增加，我们对边界点层次的刻画也更为精细。
从理论上来讲，只要我们能够取足够多的基函数数量，便能寻找到足够精细精细的边界点，从而找到足够精细的符号动力学的分界点。此外，这为我们寻找不同层次的边界点提供了一种方法：我们可以通过增加本征函数的数量来不断精确我们对边界点的划分，同时可辅以迭代关系来确定边界点的层次。图 3-14 反映了在不同基函数下通过本征函数极值点及迭代关系确定的边界点的层次。
在图 3-14 中，由于误差我们仅计算了处于层次为 15 以内的边界点：我们可以发现，很多本征函数的极值点，我们都可以通过迭代关系确定其层次。当然也存在一些其它无法确定的极值点，这可能与我们的数值计算误差有关，但是较关键的边界点都能较好的计算出，且我们可以识别大部分极值点。这使得我们通过 Koopman 算符可以对动力学系统性质的探究更深了一步：我们可以通过 Koopman 算符确定动力学系统的边界点，且可以通过增加函数格点数量来精确的寻找重要的边界点，而其他层次的边界点也可以通过迭代关系来确定。
3.1.4.3 多峰映射关于 Koopman 算符的本征函数对帐篷映射的边界点的描述我们作了一定探究，但是其对其他系统的适用性还有待进一步讨论，我们将在后面的章节中继续讨论其他映射。在这里我们讨论一些类似于帐篷单峰映射的动力学系统：多峰映射。
多峰映射也是分段线性映射，如在两个峰的情况下，我们将其相图及含噪声的相图画出 (图 3-15)，图中不同颜色的点为其不同层次性下的边界点。探究在此情形下， Koopman 算符的本征函数能否描述双峰映射的边界点。
我们取演化格点数量 n = 1000, 基函数数量 m = 2;3;4;5;8;10;15;20，高斯白噪声噪信幅值比 noise = 0:001，计算得 Koopman 算符的本征函数图像如图 3-16。
双峰映射的三个边界点 x = 1 4; 1 2; 3 4 与帐篷映射的边界点相图，但在帐篷映射中其属于不同层次，但双峰映射的这三个边界点属于同一层次。但是我们同样可以在本41images/tent/红色与青色的点表示帐篷映射的边界点，空心方块表示本征函数的极值点，且若满足迭代关系则将其边界点的层次标注在极值点附近42第三章 典型混沌系统的 Koopman 分析images/tent/tents/Tents5_noise_phase_d0.png(a) noise=0images/tent/tents/Tents5_noise_phase_d0-0(b) noise=0.001图 3-15 双峰映射不同噪声下的相空间: 图中不同颜色的点为其不同层次性下的边界点征函数图像中找到其边界点的位置：如图 3-16（h）第二个小图中，本征函数图像的极大值点与边界点吻合程度较好，且极小值点在一定程度上反映了其原像点的划分。
这与我们之前的结论是极为相似的。
当我们的双峰映射的两个峰作出一定区别时，如将相图中第二个峰的峰值减少一半，我们将其称之为大小峰映射，其相图与韩噪声的相图如图 3-17 所示。
我们取演化格点数量 n = 1000, 基函数数量 m = 2;3;4;5;8;10;15;20，高斯白噪声噪信幅值比 noise = 0:001，计算得 Koopman 算符的本征函数图像如图 3-18。
大小峰映射的三个边界点 x = 1 4; 1 2; 3 4 的性质又有所不同：其每个边界点的性质都有所差异，我们也可以在本征函数图像中观察到这种差异带来的影响：本征函数关于 x = 12 的对称性被破坏，且本征函数图像的趋势有所区别。如图 3-18(f) 第三个小图中，虽然在 x = 14 与 x = 3 4 边界点处都存在本征函数的极值点，但极值点的大小和曲率都所有差异，我们可以通过这种差异来确定这两点性质的差异。
双峰映射的边界点与本征函数 (noise = 0:001): 不同颜色的点表示大小峰映射不同层次的边界点，空心方块表示本征函数的极值点44第三章 典型混沌系统的 Koopman 不同颜色的点表示大小峰映射不同层次的边界点，空心方块表示本征函数的极值点46第三章 典型混沌系统的 Koopman 分析3.2 ж㔪⿱ᮙ᱖ሺ㌱㔕φ Logistic ᱖ሺLogistic 映射是研究动力系统、混沌、分形等复杂系统的一个经典模型，其来源于生态学中的虫口模型，用以描述种群的变化。 Logistic 映射从数学形式上来看是一个非常简单的混沌映射，但却有极其复杂的动力学行为，在保密通信领域的应用十分广泛。
3.2.1 Logistic 映射存在两个不动点： x1∗ = 0 和 x2∗ = 1 − 1g。 Logistic 映射的相图描述了相空间的映射关系：
Logistic 映射的动力学过程可以看作是在一维相空间上的拉伸再折叠的过程。通过非线性动力学的知识可以得到，该系统在 g 取不同值时表现出不同的动力学行为。
当 0 [ g [ 1 时，系统最终都会渐进的趋于 0；当 1 [ g [ 3 时，系统会收敛到一个不动点，该不动点的值为 x∗ = (g − 1)=g，此时系统的极限行为会趋于该不动点的值；
当 3 [ g [ 3:57 时，系统的迭代会出现周期行为，随着 g 的增大，周期的长度也会相应的增加，例如 2 周期， 4 周期， 8 周期轨道等，直到大约为 g = 3:57 时，周期的长度趋于无穷大；当 3:57 [ g [ 4 时，系统的迭代会在周期类型和混沌类型之间来回切换，且大部分区域呈现混沌状态；直到 g = 4 时，系统处于完全混沌的状态。
images/logistic_phase.png图 3-19 Logistic 映射的相图 (g = 4)47images/logistic_bifurcation.png图 3-20 Logistic 映射的分岔图 (2:6 ⩽ g ⩽ 4)images/logistic_lypn.png图 3-21 Logistic 映射的李雅普诺夫指数Logistic 映射的分岔图 xn −g 描述了系统随 g 表现出的不同的动力学行为：
李雅普诺夫指数是描述混沌现象的一个重要的指标， Logistic 映射的李雅普诺夫指数图像 l −a 如下图所示：根据李雅普诺夫指数的性质：当 l [ 0 时，映射系统收敛于某一不动点；当 l = 0 时，系统进行周期运动；当 l ] 0 时，系统处于混沌状态。
我们可以同样得到在 3:57 [ g [ 4 区域，系统处于混沌状态 (在 g = 3:83 处存在一三周期轨道)，当 g = 4 时系统处于混沌状态。
不失一般性，在我们的 Koopman 分析中，我们取 g = 4 的一个特例，通过 Logistic映射的动力学方程演化出一系列的数据，作为 Koopman 分析的源数据，以此来分析Logistic 映射的系统特征。
48第三章 典型混沌系统的 Koopman 分析images/logistic/Logistic_eigen_Rectangle_n1000_m4.png(a) 矩形窗基函数images/logistic/Logistic_eigen_Gauss_n100(b) 高斯基函数images/logistic/Logistic_eigen_Fourier_n1000_m4.png(c) 傅里叶基函数images/logistic/Logistic_eigen_Legendre_n(d) 勒让德基函数图 3-22 四种基函数下 Logistic 映射的本征函数 (m = 4)3.2.2 Logistic ᱖ሺ的 Koopman ㇍ㅜᵢᖷ࠳ᮦ在上一节的介绍中，我们探究了帐篷映射及其 Koopman 算符的本征函数。
Logistic 映射与帐篷映射有着非常相似的动力学特征，但其相图为非线性而非分段线性，非线性映射的一些性质会有所不同，且 Logistic 作为一个应用较广泛的混沌系统，其也有着丰富的研究价值。我们将探究 Logistic 映射 Koopman 算符的本征值与本征函数与动力学特征的关系及对相空间的划分，并将其与帐篷映射作一定的比较。
3.2.2.1 正交完备基函数空间我们选取与帐篷映射相同的参数：演化格点数量 n = 1000，函数格点数量即基函数数量 m = 4，依此计算矩阵 U 的本征值与本征函数。图 3-22 画出了 n = 1000,m = 4时，四种不同的基函数下 (矩形窗局函数、高斯基函数、傅里叶基函数、勒让德基函数） Logistic 的本征函数，其中每个基函数下又包含 4 个不同的本征值对应的本征函数。
我们可以在四种基函数下 Logistic 映射的本征函数 (图 3-22) 中得到与帐篷映射49北京邮电大学理学硕士勒让德基函数图 3-23 不同基函数数量下 Logistic 映射的本征函数类似的结论：在不同的基函数下， Koopman 算符的本征函数表现出极大的差异；本征函数总是在选取的基函数空间内，即从数学上每个本征函数都由所有的基函数线性组合而成；局部函数能通过每个基函数比例系数的大小来体现对相空间的划分，因此我们更关心这种局部函数；我们不可能选取一个完全完备的函数空间，我们的本征函数只是在此函数空间的一个近似。函数空间的维度更高，可以描述的本征函数的维度也就越高，则对于局部函数如高斯函数而言，我们描述本征函数的精细度就更高。我们取四种基函数及基函数数量 m = 2;3;4;8;10;16;20;50;100 时对应的本征值与本征函数，以此来反映出随着函数空间的精细度的提高本征函数的变化。
在图 3-23 中，我们同样发现，当基函数数量增加时，本征函数图像的频率增加了，即描述本征函数的精细度增加了。且本征函数的变化有一定的规律：随着基函数数量的增加而使得描述本征函数的精细度的增加。在 Logistic 映射中， x = 1 2 将相空间 (0;1) 分为对称的两部分，而每部分中又有极值点将每个部分各自分为两部分，这与帐篷映射的性质较为相似，但是由于 Logistic 为非线性映射，其再次进行划分的边界则与帐篷映射有所区别。
50第三章 典型混沌系统的 Koopman 分析images/logistic/Logistic_eigen_natural_n1000_m4.png图 3-24 自然基函数下 Logistic 映射的本征函数 (m = 4)3.2.2.2 自然基函数空间在式 (2-41) 中，我们通过构造自然基函数格点得到了 Koopman 算符的矩阵表示，选取合适的参数：演化格点 n = 1000，基函数数量 m = 4 下, 我们可以计算得到 4 个Koopman 算符 U 的本征值与本征函数并将其画到相空间中，如图 3-24。我们可以发现在自然基函数空间下，本征函数的图像变得更为尖锐，但也更接近 Logistic 映射的相图。当我们取不同的基函数数量 m = 1;2;3;4;5;6;7;8;9 且取 l ≈ 1 的本征函数，我们可以得到图 3-25。从图中我们可以发现，基函数数量每增加 1，极值点出现的个数近似增加两倍。而我们又考虑到 Logistic 映射 T 及其多次映射 Tn 的关系：映射次数n 每增加一次， Tn 的相图变多增加一次弯折，即极值点的数量增加一倍。这与我们看到的本征函数图像的极值点较为相似。无论是在正交完备基函数族还是在自然基函数中，我们都发现了在本征函数中的一些特殊的极值点，在帐篷映射在我们已经得到了结论：我们可以通过 Koopman 算符确定动力学系统的边界点，且可以通过增加函数格点数量来精确的寻找重要的边界点，而其他层次的边界点也可以通过迭代关系来确定。在 Logistic 映射中我们也有充分的理由相信其满足同样类似的规律。
51images/logistic/Logistic_eigen_natural_n1000_m1-2-3-4-5-6-7-8-9.png图 3-25 不同基函数数量下 Logistic 映射的本征函数迭代次数 边界点 (x = 0)1 0,12 0,0.5,13 0,0.1464,0.5,0.8536,14 0,0.0381,0.1464,0.3087,0.5,0.6913,0.8536,0.9619,150,0.0096,0.0381,0.0843,0.1464,0.2222,0.3087,0.4024,0.5,0.5975,0.6913,0.7778,0.8536,0.9157,0.9619,0.9904,1表 3-3 Logistic 映射的边界点 (x = 0): 经过多少次迭代可以到达不动点 x = 3 4，下划线的点是每层次的新增点3.2.3 Koopman ㇍ㅜሯ Logistic ᱖ሺ的⴮グ䰪࠼ࡈLogistic 映射存在两个不动点 x = 1 2 和 x = 3 4，类似于帐篷映射，我们可以得到Logistic 映射一系列的边界点。不动点 x = 0 的一系列原像点如表 3-3 所示。将其按照ቸ⅗（经过多少次演化才达到不动点）作出图像，如图 3-26。
同样，对于另一个不动点 x = 3 4，我们同样作出其一系列原像点 (表 3-4)，且按层次绘制其在相空间的位置 (图 3-27)。
类比帐篷映射，我们将本征函数和边界点的位置进行对比观察：在图 3-28 中，我们取不同的基函数数量 m = 2;3;4;5;8;10;15;20, 并绘制最多 9 个本征函数图像，将本征函数图像的极值点标出，并将 Logistic 的边界点同时标出，以此来对比二者之间52第三章 典型混沌系统的 Koopman 分析images/logistic/Logistic_boundarys_x0.png图 3-26 Logistic 映射的边界点 (x = 0): 相同大小和颜色的点同属于一个层次迭代次数 边界点
我们观察本征函数的极值点与 Logistic 的边界点，在图 3-9(a) 的第二个小图中，我们观察到基函数 m = 2 时本征函数存在一个极值点，其与边界点 x = 1 2 是比较吻合的。随着基函数数量的增加 m = 3;4;5;8;10 时， x = 0:1464;0:8536 处附近的极值点越来越逼近这两个边界点，当 m = 15 时， x = 0:1464;0:8536 处附近各存在一个极值点；
当 m = 20 时，极值点与边界点吻合的较好。
结合帐篷映射我们可以得出与之一致的结论： Koopman 算符的本征函数的极值点反映了 Logistic 映射的边界点，且随着本征函数基函数数量的增加，函数格点的增加使本征函数的精细度增加，从而能更精确的刻画 Logistic 映射的边界点; 我们可以依本征函数的极值点对相空间区域进行划分;Koopman 算符的本征函数极值点可以反映符号动力学的分界点。
通过帐篷映射与 Logistic 映射中一致的结论，我们可以大胆的将此结论应用到更复杂的系统中，当我们面对一个较复杂的系统时，我们可以通过 Koopman 算符的本征函数寻找其极值点，来寻找该系统对应的符号动力学的分界点。且随着我们增加基函数的数量，我们便能更精细的刻画符号动力学的分界点。从而使我们对该动力学的特征能够有着粗粒度的认识。
3.2.4 ᴪཐ的䇞论在帐篷映射中我们对 Koopman 算符的本征函数的极值点反映了帐篷映射的边界点的结论作了一定的探究，为了揭示此规律的普遍性，在本小节中我们将对噪声下的 Logistic 映射和寻找更精细的边界点这两个问题进行讨论，同时与帐篷映射进行对比。
在噪声情况下，假设我们的涨落符合高斯白噪声分布，将 Logistic 映射加入噪声项得到含噪声的 Logistic 映射：
xn+1 = f(xn) = gxn(1−xn)+x (3-7)其中高斯分布的方差作为信噪比的参数可供调节， Logistic 映射在不同噪声大小下的相图如图 3-29 所示。若 Koopman 算符对边界点的划分具有鲁棒性，则在此噪声影响下， Koopman 算符对边界点的划分应与之前相同。
我们取 Logistic 映射在 noise = 0:001 与 noise = 0:01 时 Koopman 算符对应的本征函数，如图 3-30 与图 3-31。同样我们在图中标出本征函数极值点的位置，及 Logistic54第三章 典型混沌系统的 ise=0.01图 3-29 Logistic 映射不同噪声下的相空间:noise 表示噪声与函数幅值之比边界点的位置，对比图 3-28 来探究 Koopman 算符对边界点划分的鲁棒性。同时，我们在计算 Koopman 算符的矩阵表示时每次从 K 到 L 进行了多次的演化，并取演化的平均值。
在图 3-30(a) 第二个小图中，我们观察到由于噪声项的影响， Koopman 算符的本征函数的极值点与边界点 x = 1 2 会有一定距离的偏移，随着基函数数量的增加，本征函数的细节上会有些许变化，但是大致趋势并未发生明显的变化。图 3-31 中增加了噪声的大小 noise = 0:01，本征函数图像变得更不规则了，但总体观察 Koopman 算符本征函数的极值点，其噪声对其划分边界点的影响并不大。如在图 3-31(h) 第四个小图中，本征函数的细节变的稍稍不规则，但是在边界点 x = 12 附近处与边界点x = 0:1464;0:8536 处同样存在较明显的本征函数极值点，且处于不同层次。综上我们可以确定， Koopman 算符的本征函数的极值点对边界点的划分这一结论是具有鲁棒性的，与帐篷映射中的结论一致。
同样，我们要验证随着基函数的增加，本征函数是否能更精确的划分我们的边界点。在两个基函数数量 m1 和 m2 下通过本征函数 ϕm1 来确定 ϕm2 下的本征函数，利用函数最小值对应的参数问题 (式 3-5), 及利用本征函数之间的相似性（式3-4)。我们可以作出图 3-32 中，我们根据寻找函数式 3-5 最小值进行了四组对比：
m = 8;16,m = 16;32,m = 32;64,m = 64;128, 在每个图中，蓝色的线表示较小的基函数数量下的本征函数，我们以此蓝色的本征函数 ϕm1 为基础，根据式 3-5 计算得到较大的基函数数量下的本征函数，即红色的本征函数 ϕm2。
在图 3-32(b) 第四个小图中，随着基函数数量扩大一倍，本征函数的极值点的数量也增加了一倍左右，且红色本征值的极值点并未丢失蓝色本征值的极值点，且红色本征值的极值点较蓝色本征值点增加了一些点，通过数据上的验证，我们发现这些多出来的极值点恰好处于某一层次下的 Logistic 的边界点。这说明了随着基函数数量的增映射本征函数不同基函数数量之间的对应关系 (n = 1000): 根据较小基函数数量的本征函数 (蓝色) 寻找满足条件的较大基函数数量的本征函数 (红色)这个结论得到了与帐篷映射一致的结论： Koopman 算符的本征函数的极值点反映了 Logistic 映射的边界点，且随着函数格点数量的增加，我们对边界点层次的刻画也更为精细。这为我们寻找不同层次的边界点提供了一种方法：我们可以通过增加本征函数的数量来不断精确我们对边界点的划分，同时可辅以迭代关系来确定边界点的层次。图 3-33 反映了在不同基函数下通过本征函数极值点及迭代关系确定的边界点的层次。
在图 3-33 中，我们计算了处于层次为 15 以内的边界点：我们可以发现，很多本征函数的极值点，我们都可以通过迭代关系确定其层次，并识别大部分极值点。我们可以通过 Koopman 算符确定动力学系统的边界点，且可以通过增加函数格点数量来精确的寻找重要的边界点，而其他层次的边界点也可以通过迭代关系来确定。
tic 映射本征函数确定边界点层次 (n = 1000;noise = 0): 红色与青色的点表示Logistic 的边界点，空心方块表示本征函数的极值点，且若满足迭代关系则将其边界点的层次标注在极值点附近60第三章 典型混沌系统的 Koopman 分析3.3 ӂ㔪⿱ᮙ᱖ሺ㌱㔕φ෹ߒ᱖ሺ埃农（Hénon）映射是 1976 年由法国数学家 Michel Hénon 提出的。 Hénon 映射是一种可以产生混沌现象的离散映射系统。最近，用埃农映射产生的混沌序列进行图像加密的报道逐渐增多。
3.3.1 ෹ߒ᱖ሺ的࣑ࣞᆜ埃农映射的迭代方程可以描述为8][]:
xn+1 = yn +1−axn2yn+1 = bxnx;y 2 [−1:5;1:5] (3-8)其只有一个非线性项，埃农映射的映射过程可以埃农映射存在两个不动点： x∗ = b−1±√(b−1)2 +4a2a ;y∗ = bx∗。在经典的埃农映射中，我们通常取 a = 1:4 与 b = 0:3，此时该映射出现奇怪吸引子并表现出混沌现象，在该参数下，埃农映射的吸引子和不动点如下图： 
在我们的 Koopman 分析中，我们在取上述参数值的情况下，通过 Hénon 映射的迭代方程演化出一系列的数据，作为 Koopman 分析的源数据，以此来分析 Hénon 映射的系统特征。
 3-34 埃农映射的吸引子和不动点（a = 1:4;b = 0:3） : 蓝色的点表示经过多次迭代后落到的相空间中的吸引子，红色的点表示埃农映射的不动点3.3.2 ෹ߒ᱖ሺ的 Koopman ㇍ㅜᵢᖷ࠳ᮦ在之前的章节中，我们探究了帐篷映射、 Logistic 映射一维映射 Koopman 算符的本征值与本征函数及对边界点的划分。埃农映射是一个二维映射，在二维映射中Koopman 算符本征函数的计算与一维大致相同又稍有区别。且本征函数对相空间的划分又与一维情况有所不同，二维映射的动力学特征也更为复杂。在本节中，我们将探究 Koopman 算符的本征值与本征函数与埃农映射的动力学特征的关系及对埃农映射相空间的划分。
3.3.2.1 正交完备基函数空间埃农映射是一个二维映射，在二维函数空间中，二维高斯基函数可以写为：
3-10)62第三章 典型混沌系统的 Koopman 分析其中 C 为常系数， (xj;y j) 为高斯波包的中心位置， d j 表示格点宽度，且我们在两个方向上并无相关性。二维傅里叶基函数可以写为：
)其中 m;n 表示两个方向上的频率， 1p:5 表示在埃农映射相空间 [−1:5;1:5] × [−1:5;1:5]的缩放因子。我们将某一时刻的二维数据矩阵作为一组状态变量，并求得每个基函数在此状态变量下的值，作为数据矩阵，以此求得演化前矩阵 K 和演化后矩阵 L，根据式 (2-31)，计算 Koopman 算符 U 的矩阵表示及其本征值与本征函数。
图 3-35 画出了演化格点数量 n = 100 × 100 时，在二维高斯基函数、二维傅里叶基函数下埃农映射的本征值与本征函数。我们取相空间 [−1:5;1:5] × [−1:5;1:5], 并取前 9 个本征值接近 1 对应的本征函数。当本征函数值为复数时，我们取其实部作为我们的本征函数值。同时，我们将本征函数的实部、虚部、模、幅角在高斯基函数的本征函数图像表示在图 3-36 中。
从图 3-35 中，我们发现在高斯基函数和傅里叶基函数两种基函数下，本征函数的图像有着固定的差别：高斯基函数本征函数图像的连续性与平滑性较好，傅里叶基函数本征函数图像存在许多断断续续的极值点。但我们似乎可以观察到其二者的轮廓有着相似的结构。在之前的讨论中，我们提到，本征函数总是在选取的基函数空间内，即从数学上每个本征函数都由所有的基函数线性组合而成。因此我们的本征函数只是在此函数空间上的一个近似 (或者说是函数几何空间从高维到低维的投影)，因此基函数的选取会影响本征函数空间，因此我们对基函数的选取亦至关重要。为了能更好的划分出相空间，我们应尽量体现出不同基函数的作用，以此对相空间进行划分。显然，二维高斯基函数的局部性更好，而二维傅里叶基函数在其相空间属于全局函数，不利于对相空间划分的表示。为此，在我们后面的讨论中，我们将选取高斯基函数来讨论 Koopman 算符的本征函数。
在图 3-35 中，每个子图中都包含 4 个不同的本征值及其对应的 4 个本征函数图像，且其中包含一个 l ≈ 1 的本征值，在之前的讨论中，我们认为本征值接近 1 的本征函数反映了相空间中一条随时间演化不变的轨道。而我们在矩形窗基函数和傅里叶基函数中也确实看到了这样的常函数轨道。而其他的本征值则不趋于 1，这也可以从我们对函数空间选取的不够完备去考虑：我们不可能选取一个完全完备的函数空间，我们的本征函数只是在此函数空间的一个近似。
图 3-35 中画出了 m = 4 时的本征函数，当 m 取不同值时，如 m 越来越大时，意63images/henon/Henon_eigen_Gauss_n100m50md45.png(a) 高斯基函数images/henon/Henon_eigen_Fourier_n100m50.png(b) 傅里叶基函数图 3-35 埃农映射不同基函数的本征函数64第三章 = 1002,m = 502;dj = 45 3 ): 每个子图中又分为四个小图，分别表示本征函数的实部、虚部、模、幅角65味着我们的函数空间的维度更高，可以描述的本征函数的维度也就越高，则对于局部函数如高斯函数而言，我们描述本征函数的精细度就更高，于是我们可以提高基函数数量 m 的大小，用以描述更精细的本征函数。
在后续的讨论中，我们会在埃农映射的吸引子域中作 Koopman 算符的本征函数。
为了更好的对比，我们将吸引子域中埃农映射在二维高斯基函数中的本征函数图像作出，以作对比。
图 3-37 画出了当吸引子演化格点数量 n = 6245, 高斯基函数数量 m = 50×50 =2500 时的本征函数图像，在二维平面图中不易观察其本征函数值之间的关系，为此我们在三维中作图，并将 z 轴的高度作为本征函数值的大小，并调整了视角，使得我们可以更清晰的观察本征函数值。
图 3-38 画出了当 m = 22;32;42 时，埃农映射在吸引子域上的本征函数图像，且最多取其前 9 个本征函数。从图中可以看出，随着基函数数量的增加，本征函数的极值点也随之增加。
3.3.2.2 自然基函数空间在式 (2-41) 中，我们可以通过构造自然函数格点来计算 Koopman 算符的本征值与本征函数，但这与在一维的情况稍有不同，自然基函数是由粒子的演化得到的，而二维映射中存在两组演化，且每组演化都可以作为一组自然基函数，所以我们在求本征函数时需要区分演化的维度，即是 x 方向的本征函数还是 y 方向的本征函数。同时，由于自然演化在埃农映射中并不能遍布整个相空间：因为埃农映射并不是相空间到自身的映射，且其存在收缩性，故我们不能将本征函数画在整个相空间中。但是在埃农映射中存在一吸引子区域满足到自身的映射，在吸引子上的粒子可以通过迭代映射遍历整个吸引子，于是在自然基函数空间中，我们选取吸引子作为我们的相空间，在吸引子区域作出本征函数图像。
图 3-39 画出了在演化格点数量 n = 2000，自然基函数数量 m = 4 时，不同本征值下的埃农映射在吸引子域上的本征函数图像，由于吸引子域较小不易表示，我们在每个子图中分为四个小图，其中前两个小图表示 x 方向和 y 方向上的本征函数的三维鸟瞰图及其在 xy 平面上的投影，后两个小图表示二维中的本征函数图像。
我们可以在图 3-39 得到与一维映射类似的一些关键点：在埃农映射的吸引子中，点 (1:25;0) 附近存在一个较明显的转折点，在这个点上的本征函数总是会出现极值点。类比一维映射中的边界点，我们可以猜测这个点也可埃农映射自然基函数下的本征函数 (n = 2000,m = 4): 每个子图表示不同本征值下的本征函数图像，其中每个子图又分为四个小图，其中前两个小图表示两个方向上的本征函数的三维鸟瞰图及其在二维的投影，后两个小图表示二维中的本征函数性质。
图 3-40 画出了当基函数数量 m = 1;2;3;4;5;6;7;8;9 时关于 x 方向上的所有 m 个本征函数图像。随着基函数数量的增加，本征函数图像的结构也变得更复杂，且基函数数量每增加 1，极值点出现的数量增加近似一倍，这与我们在一维映射中的结论一致。在 m = 1 时，本征函数图像有且仅由一个点，且该点将埃农映射的吸引子分为了两部分；当 m = 2 时，极值点出现了三个，且多出来的两个点又将每部分分为了各自的两部分，而在埃农映射中，埃农映射 T 一次映射即体现一次弯折，多次映射 T n就会体现多次弯折。若我们能证明这些极值点与埃农映射的边界点一致，我们便可以得到与一维映射一致的结论。
当 m = 1;2;3;4;5;6;7;8;9 时，我们每个基函数仅取一个本征函数图像，观察随着基函数的增加，本征函数的图像如何变化，如图 3-41。
结合图 3-40 与图 3-41，我们观察到，随着基函数数量的增加，本征函数图像增加了一些极值点，但并未丢失之前的极值点，若我们可以证明这些极值点属于埃农映射不同层次的边界点，我们便可以得出和一维映射一致的结论： Koopman 算符的本征函数的极值点反映了埃农映射的边界点，且随着基函数数量的增加，能区分更69北京埃农映射自然基函数不同基函数数量下的本征函数 (n = 2000): 图中颜色值及高度值均表示本征函数值的大小，且其在 xy 平面的投影为二维吸引子域70第三章 典型混沌系统的 Koopman 分析images/henon/natural/Henon_eigen_natural_n2000.png图 3-41 埃农映射自然基函数不同基函数数量下的本征函数 (n = 2000): 图中颜色值及高度值均表示本征函数值的大小，且其在 xy 平面的投影为二维吸引子域横坐标 x 纵坐标 
3.3.3 Koopman ㇍ㅜሯ෹ߒ᱖ሺ的⴮グ䰪੮ᕋᆆ࠼ࡈ在埃农映射的本征函数图像中，我们可以发现一些关键的本征函数的极值点，若能证明这些极值点对应埃农映射的边界点，我们便可以得出和一维映射一致的结论： Koopman 算符的本征函数极值点反映了动力学系统的边界点。针对埃农映射的边界点，我们可以通过寻找其在吸引子图像中的转折点寻找到，为了较精确的计算出埃农映射的边界点，我们可以取其曲率较大的点，我们通过计算得到埃农映射中四个较关键的边界点，如表 3-5。我们将埃农映射的边界点与吸引子画在一起，如图3-42，观察其位置发现，这些点都处于埃农映射吸引子最主要的弯折区域，由于埃农映射的吸引子是一个分形结构，因此在弯折区域存在 4 个边界点。为了能寻找到其 埃农映射的边界点及其像点、原像点他层次的边界点，我们对埃农映射的四个边界点进行正向演化得到其像点，反向演化得到其原像点，如图 3-43，我们将正向演化及其次数用正数标注在图中，将反向演化及其次数用负数标注在图中， 0 表示最原始的四个边界点。在之前的讨论中，我们称边界点的原像点为其他层次的边界点，在此处我们同样这样定义。我们对比本征函数图像的极值点及埃农映射的边界点。
72第三章 典型混沌系统的 Koopman 分析我们选取自然基函数，并取演化格点数量 n = 2000，函数格点数量 m =1;2;3;4;5;6;7;8, 分别作本征函数图像，并将边界点的位置标出，如图。在图 3-44(b) 中，基函数数量 m = 2，本征函数在每条线上存在 1 个极值点共计 4 个极值点且与我们层次为 0 的边界点一一对应，在图 3-44(c) 中，基函数数量 m = 3，本征函数在每条线上存在三个极值点，且与我们层次为 −1;0 的边界点一一对应，同样的，随着基函数数量的增多，本征函数图像的极值点也随之增多，我们也将更多层次的边界点画在图中，我们发现，本征函数值的极值点总是能和埃农映射的边界点有着对应关系，并且基函数数量每增加 1，本征函数图像反映的边界点层次也随之增加 1。
这个结论与一维映射的结论一致，且定量的描述了基函数数量的增加对边界点层次的影响。
为了反映这种变化关系，我们每个基函数数量下取一个本征函数，画出随基函数增加，本征函数极值点与埃农映射边界点的关系，如图 3-45。从图中，我们可以更清晰的发现这个结论： Koopman 算符的本征值反映了埃农映射的边界点，且随着基函数数量的增加，能够反映出埃农映射不同层次的边界点，基函数数量每增加 1，埃农映射的边界点便能反映更多一个层次。
3.3.4 ᴪཐ的䇞论3.3.4.1 埃农映射的周期轨道在这里我们讨论埃农映射的周期轨道，在第二章中我们讨论了周期轨道对相空间动力学特征的划分，周期轨道也是动力学特征的重要部分。为此我们可以通过Multipoint Shooting 的方法计算得到埃农映射不同周期的周期轨道，如图 3-46, 我们计算了 T = 2;3;4;5;6;8;9;10 时埃农映射的周期轨道。在第二章的讨论中我们了解到，在离散映射系统中，设有一周期为 T 的动力学系统 xn+T = f T(xn) = xn，若定义一个新的映射 F = f T，则对于新的映射 F，我们有 F(xn) = xn, 即 xn 为新映射系统的不动点。新映射 F 与原映射 f 之间为 T 次映射，在相空间可表示为 T 次重复变换过程。为此，我们将周期点看作新映射的不动点，并将这些不动点在新映射上进行线性化，如图 3-47，我们选取本征函数参数：演化格点数量 n = 100×100, 高斯基函数数量 m = 50×50，周期轨道参数 T = 2;4;6;7，分别对比其周期轨道位置及其线性化方向。我们同样选取 T = 12 时周期轨道与本征函数的对比，并将其放大观察，如图3-48。结合图 3-47 与图 3-48 我们发现，周期轨道分布在吸引子域上，且其存在两个本征方向，一个方向是稳定的，另一个方向是不稳定的，且稳定的方向即沿着吸引73images/henon/埃农映射的边界点与本征函数对吸引子的划分 (n = 2000): 彩色的点表示本征函数值，蓝色的点表示本征函数在 xy 平面上的投影，在投影上我们用不同颜色的点标注了不同层次的边界点位置，且将这些点沿 z 轴正方向延伸便于对比 74第三章 典型混沌系统的 Koopman 分析i 3-45 埃农映射的边界点与本征函数对吸引子的划分 (n = 2000)images/henon/period/Henon_periodic_orbits.png图 3-46 埃农映射的周期轨道: 在每个子图的标题中， T 表示周期， symbol 表示符号动力学允许的最多轨道数， num 表示我们寻找到的收敛的轨道数量，并将这些轨道画在同一张图中， num=0表示没有计算到该周期下的轨道，但并不意味着不存在此周期，因为 Multipoint Shooting 的方法受到初始点选取的限制75 埃农映射的本征函数与周期轨道 (n = 1002,m = 502;dj = 45 3 ): 粉色区域表示本征函数值的大小，绿色的线表示吸引子域，黑色的点表示某周期下埃农映射的周期轨道，且每个周期点上存在两个本征方向用箭头表示，蓝色表示不稳定方向，红色表示稳定方向。
子方向，不稳定的方向沿着埃农映射的本征函数流向，于是我们可以猜测，在相空间 [−1:5;1:5]×[−1:5;1:5] 中，埃农映射的本征函数图像的流向与埃农映射的不稳定流型一致。
3.3.4.2 埃农映射的不稳定流型在上一节中，我们得出了一个猜测：埃农映射的本征函数图像的流向与埃农映射的不稳定流型一致。我们将在此节对此猜测作进一步的印证。
我们可以通过数值计算得出埃农映射的不稳定流型：在数值计算中，我们可以先将埃农映射迭代 n 次，再讲埃农映射迭代 −n（负数表示反向迭代），理论上这样点的位置不会发生变化，但是由于数值计算误差，若初始点不处于不稳定流型，则正向迭代会使其发散，且放大数值计算造成的误差 (即使误差很小), 这样，粒子再反向迭代回来之后，便很难回到原来的位置。若初始点处于不稳定流型区域中，正向迭代会使其趋于流向吸引子域而非发散，这样反向迭代便可以回到其原来的位置，我76第三章 典型混沌系统的 Koopman 分析images/henon/period/Henon_eigen_Gauss_period1_n100m50T12.png图 3-48 埃农映射的本征函数与周期轨道 (T=12)：粉色区域表示本征函数值的大小，绿色的线表示吸引子域，黑色的点表示某周期下埃农映射的周期轨道，且每个周期点上存在两个本征方向用箭头表示，蓝色表示不稳定方向，红色表示稳定方向。
们可以利用这样的数据计算技巧确定埃农映射的不稳定流型区域，如图 3-49, 我们取遍布整个相空间的初始点，并画出了当反复迭代次数为 2;5;8;11;14;17;20;23;26 时埃农映射的迭代图。从图中我们可以看到，随着迭代次数的增加，原来处于整个相空间区域的点只剩下了一部分，而这剩下的一部分恰好就反映了不稳定流型的区域。
我们取迭代次数为 20 下的不稳定流型区域，并将其与某一个本征函数作对比，如图 3-50。我们发现，本征函数有明显变化的区域与我们通过迭代寻找到的不稳定流型的区域吻合，这说明了我们得到的本征函数图像的流向恰好就是埃农映射的不稳定流型。为了进一步印证我们的猜想，我们可以较严格的画出埃农映射的不稳定流型。具体方法为，从周期点出发，根据其线性化方向，对其临近的点进行演化，若我们演化的间隔足够小，我们便可以通过将这些轨迹连接起来得到埃农映射的不稳定流型。为了使我们演化的间隔比较均匀， Hobson 提出了一种演化不稳定流型的计算方法，我们利用这种方法，画处 T = 4 时，由周期轨道演化而成的埃农映射的不稳定流型，如图 3-51。当周期 T = 7 时，我们可以计算得到四组不同的周期轨道，我们分别计算这四组轨道下演化而成的埃农映射的不稳定流型，并将其与本征函数作为对比，如图 3-52。结合图 3-51 与图 3-52。我们发现，周期轨道粉色区域表示埃农映射的本征函数，黑色的点表示周期 4 轨道的位置，两个本征方向用蓝色与红色箭头标出，沿着不稳定方向 (蓝色) 演化而成的不稳定流型用实线标出，且四个点演化而成的不稳定流型轨道颜色不同流型与埃农映射的本征函数流向一致，且在一条不稳定流型轨道上，本征函数值的大小几乎一致。于是我们可以有结论：在埃农映射中， Koopman 算符的本征函数流向与不稳定流型一致，在同一条不稳定流型轨道中，本征函数值的大小几乎相同。
农映射的不稳定流型与本征函数 (T=7)：粉色区域表示埃农映射的本征函数，黑色的点表示周期 4 轨道的位置，两个本征方向用蓝色与红色箭头标出，沿着不稳定方向 (蓝色) 演化而成的不稳定流型用实线标出，且四个点演化而成的不稳定流型轨道颜色不同80第三章 典型混沌系统的 Koopman 分析3.4 п㔪䘔㔣ᰬ䰪㌱㔕φ⍑՜ޯ㌱㔕洛伦兹 (Lorenz) 系统是 1963 年由 Edward Lorenz 提出的描述空气流体运动的一个数学模型。 1998 年， S.Smale 提出 21 世纪的 18 个著名的数学问题，其中第 14 个问题就是关于洛伦兹系统的研究。迄今为止，对洛伦兹系统的研究无论是从数学、物理还是工程上都是十分重要的问题。
3.4.1 ⍑՜ޯ㌱㔕的࣑ࣞᆜ洛伦兹系统的动力学方程表示为：
、该方程描述了一个三维相空间的三个分量对时间的变化率。其中 x 代表对流强度， y 代表上升流和下降流的温差,z 代表铅直方向温度分布的非线性强度。 c 是Rayleigh 数，为系统的主要控制参数， a 是 Prandt 数， b 是外形比。 Lorenz 系统具有非线性、非周期性和确定性的性质。参数 s,r,b 取不同值时 Lorenz 系统表现出不同的动力学行为。如在 r [ 1 时，系统只有一个不动点，即原点，所有轨道的长期行为都趋于原点；当 r = 1 时系统发生了叉式分岔，在 r ] 1 时出现了两个不动点，不动点的稳定性可由其他参数满足的条件确定。三个不动点的坐标分别为 。当我们将三个参数取一组特定的值 r = 28,s = 10,b = 8=3 时， Lorenz 方程的解是混沌的，相空间会存在两个奇异吸引子。
洛伦兹系统的这种动力学特征用传统的非线性动力学知识是比较难分析的, 其相图如下：在洛伦兹系统中，所有的非平衡解最终趋向同一个复杂的集合，这就是所谓的洛伦兹吸引子。我们将在取上述参数的条件下，通过 Lorenz 微分方程演化出相空间的一条轨道，作为 Koopman 分析的源数据，以此来分析 Lorenz 系统的特征。
3.4.2 ⍑՜ޯ㌱㔕的 Koopman ㇍ㅜᵢᖷ࠳ᮦ我们已经探究了帐篷映射、 Logistic 映射、埃农映射系统中 Koopman 算符的本征值与本征函数。洛伦兹系统是一个三维流系统，在三维流系统中 Koopman 算符的本征函数的计算又稍有区别，三维流系统中还涉及到时间维度的动力学，且动力学81images/lorenz_phase.png图 3-53 洛伦兹系统的相图 (r = 28,s = 10,b = 8=3）特征也更为复杂。在本节中，我们将探究 Koopman 算符的本征值与本征函数与洛伦兹系统的动力学特征的关系。
3.4.2.1 正交完备基函数空间洛伦兹系统是一个三维流系统，在三维函数空间中，三维高斯基函数可以写为、 为高斯波包的中心位置， dj 表示格点宽度，且我们在两个方向上并无相关性。
我们将某一时刻的二维数据矩阵作为一组状态变量，并求得每个基函数在此状态变量下的值，作为数据矩阵，以此求得演化前矩阵 K，经过一个微笑的时间t = 0:001s 演化后，我们得到演化之后的数据矩阵，并计算每个基函数在此状态变量下的值，以此求得演化后矩阵 L。根据式 (2-31)，计算 Koopman 算符 U 的矩阵表示及其本征值与本征函数。
图 3-54 画出了演化格点数量 n = 10000，在三维高斯基函数下洛伦兹系统的本征值和本征函数，其中数据矩、们取相空间 [−20;20]×[−20;20]×[0;50]，并取前 9 个本征值接近 1 对应的本征函数，当本征函数为复数时，我们取实部作为我们的本征函数。同时，我们分布画出了本征函数的实部、虚部、模、幅角。
从图 3-54 中，我们发现在高斯基函数下，洛伦兹系统的吸引子随着时间演化在本征函数中有着一定分布，且本征函数值的不同将洛伦兹吸引子划分出不同区域，如在图 3-54 实部的第 2 张子图中，随着时间的演化，洛伦兹系统在每圈演化中分别经历了蓝色和红色的本征值，具有近似的周期行为。若我们关心最关键的分隔区域，我们可以考虑观察洛伦兹系统的本征函数的幅角，因为幅角可以将本征函数值限定在[−180 ;180 ]，我们通过观察幅角的正负来将吸引子划分为两个动力学性质不同的区域。图 3-55 画出了根据本征函数幅角的正负将吸引子区域划分的结果。
在图 3-55 中，我们选取了 4 个实本征值对应的本征函数，并取本征函数的幅角作图，图中可以看出红色区域和蓝色区域将洛伦兹系统的吸引子分成了两块不同的区域，在之前的讨论中，我们认为本征值接近 1 的本征函数反映了相空间中一条随时间演化不变的轨道，我们可以认为我们划分的两个区域属于洛伦兹系统的一个不83images/lorenz/Lorenz_eigen_Gauss_leftU_realL_n10000m960.png图 3-55 洛伦兹系统三维高斯基的本征函数 (幅角)(n = 10000;m = 960)变集，而这种不变集可能就对应洛伦兹系统的周期轨道。
3.4.2.2 自然基函数空间在式 (2-41) 中，我们可以通过构造自然函数格点来计算 Koopman 算符的本征值与本征函数，洛伦兹系统是一个三维流系统，其存在三个维度，每个维度都可以作为一组自然基函数，于是我们在吸引子区域分别画出了三个维度的自然基函数空间下的本征函数，并分别取本征的实部与模作图。
图 3-56 画出了在演化格点数量 n = 10000, 基函数数量 m = 4 时，不同本征值下洛伦兹系统在吸引子域上的本征函数图像，每个子图都画了三个维度的本征函数，其中第一行表示本征函数的实部，第二行表示本征函数的模。
图 3-56 中我们可以看出在自然基函数下，本征函数展示出了倍频特征，随着时间的演化，本征函数在每圈吸引子的演化中有着近似周期性的规律，为了更清晰的揭示这种规律，我们画出在不同基函数 m 下的本征函数，以此来探究自然基函数中基函数个数对本征函数的影响。
图画出了在演化格点 n = 10000，基函数数量 m = 1;2;3;4;5;6;7;8，计算 x 维度本征函数的实部，不同本征值下洛伦兹系统在吸引子域上的本征函数图像。
图中可以看出，随着基函数数量的增加，本征函数的数量也变得更多，吸引子84第三章 典型混沌系统的  每个子图表示不同本征值下的自然基函数本征函数图像，其中每个子图又分为六个小图，其中第一行表示本征函数的实部，第二行表示本征函数的模上的倍频特征也越来越明显，如 m = 1 时，不存在倍频特征，且本征函数将洛伦兹吸引子的左右两瓣划分为不同区域；当 m = 2;3;4 时，本征函数在随着吸引子的演化中近似出现了一倍频；当 m = 5;6 时，本征函数在随着吸引子的演化中近似出现了二倍频；当 m = 7;8 时，本征函数在随着吸引子的演化中近似出现了三倍频。这个结论与低维映射中有一定一致性：随着基函数数量 m 的增加，相空间的一次演化 f 即体现一次变换，多次演化 f n 就会体现多次变换，这种变换便对应了本征函数的倍频特征。
若我们将这种变换与低维映射中拉伸折叠相对应起来，我们便可以得到与低维系统一致的结论。
3.4.3 Koopman ㇍ㅜሯ⍑՜ޯ㌱㔕的⴮グ䰪࠼ࡈ在洛伦兹系统的本征函数图像中，在高斯基函数中，我们通过本征函数可以对相空间进行一定区域的划分，如使用本征函数的幅角正负可以将本征函数划分为两个区域，而这两个区域可以将吸引子划分为两个不变集，这两个不变化很可能与洛伦兹系统的周期轨道相对应，若我们根据本征函数值对吸引子划分，我们还可以得到更细致的划分，而这些划分是否能得到与低维系统一致的结论还需要进一步的讨论。
洛伦兹系统不同自然基函数数量下的 real(x) 本征函数 (n = 10000)86第三章 典型混沌系统的 Koopman 分析在自然基函数中，我们观察到本征函数的倍频特征，仅倍频数量随着基函数的增加而增加，基函数数量对应着自然基函数演化变换的次数，这种变化与低维映射中的拉伸折叠相对应，也可以得到和低维系统一致的结论。
关于 Koopman 算符对洛伦兹系统的相空间划分的验证则仍需要进一步的讨论。
87第四章 总结与展望ㅢ഑ㄖ ᙱ㔉фኋᵑ4.1 ᙱ㔉Koopman 算符描述了相空间的函数的演化，我们可以用 Koopman 算符分析系统的演化特征，寻找动力学系统的演化规律。通过对 Koopman 算符进行谱分解，我们可以得到其本征值与本征函数，我们关心 l ! 1 的本征值及其对应的本征函数，由于我们基函数选取的总是不够完备，因此我们的本征函数可能会小于 1。我们关心较大的本征值并将其本征函数描绘在相空间中，此时 Koopman 算符的本征函数存在一些极值点，通过我们先前的讨论，这些极值点对应着我们符号动力学边界点的划分。
基函数的不同，会导致 Koopman 算符在不同函数空间的表示的不同，高斯基函数是一组近似局部、近似完备的函数空间，我们可以将 Koopman 算符的本征函数在此空间中描述，但是由于我们的基函数数量总是有限的，而 Koopman 算符的本征函数作为无限维的函数，我们得到的本征函数值只是在此函数空间中的一个投影。但同时有限个基函数可以使我们一定可以观察到在每个基函数上的权重的不同，从而使我们对相空间的区域进行划分，这些划分的区域代表了相空间不同的动力学特征。
在自然基函数空间中，我们仅利用一组粒子的演化数据作为一组基函数，并将该组基函数演化 m 次来计算 Koopman 算符的本征函数。由于粒子的演化数据随着动力学方程分布，因此我们可以通过有限次迭代来反映动力学的演化规律。在动力学中我们每演化一次，我们的相空间就会发生一次变换 (通常是拉伸再折叠的过程)，Koopman 算符的本征函数也反映了这种规律：基函数的数量 m 每增加 1， Koopman算符的极值点数量近似增加一倍，对应的边界点的位置也增加了一倍，反映出边界点的层次也增加了一层。
Koopman 算符可以用于任何其他的动力学系统。 Koopman 算符的本征值与本征函数为我们寻找符号动力学的边界点提供了一种计算方法：对于一个复杂系统，有时我们无法精确描述其动力学特征，我们可以通过符号动力学的划分对其进行粗粒度的描述。我们可以通过 Koopman 算符的本征值与本征函数寻找其极值点，来寻找该系统对应的符号动力学的分界点。且随着我们增加基函数的数量，我们便能更精细的刻画符号动力学的分界点。当我们基函数的数量取的足够多时，理论上我们可以寻找到其所有的边界点。若能找到动力学系统的边界点，我们便可以通过一组符89号序列对相空间的不同区域进行描述，并划分出相空间，进一步讨论这些不同区域的动力学特征，通过符号动力学的符号序列，我们还可以预测系统的长期行为。由于其在复杂系统中的普适性，我们可以将 Koopman 分析应用到各种复杂问题上，如生物大分子的运动、流体系统、模式识别以及气候变化等。
4.2 ᭯䘑グ䰪਀ኋᵑKoopman 算符描述了相空间可观测函数的演化，并可以找到重要的动力学模式。
在 Koopman 算符的谱分解中，可以识别出许多本征值和本征函数，但是要找出最相关的本征值并解释其动力学意义仍然是一个巨大的挑战。在本文中，我们选取了适当条件的本征函数的极值，并与一些混沌系统中符号动力学的边界点位置作了一定的对比，发现它们在一定误差范围内重叠在一起。在我们选取的一定的基函数下，很容易可以计算出 Koopman 算符的谱，且精度随着基函数的数量增加而增加。与其他基函数相比，直接从演化数据中提取的自然演化的基函数是最有效的，且这种方法应适用于其他非线性与混沌系统。
在非线性系统的研究中，符号动力学的划分一直是一个关键的问题，尤其当相空间的维度是高维时。过去的方法都集中在构造稳定和不稳定的流形或确定某些拓扑指数上，这些特征在轨道结构比较复杂时很难计算，比如在耦合的非线性系统中。
在本文中，通过计算 Koopman 算符的谱特征采取了完全不同的路线，从而避免了对相空间复杂的几何特征进行描述。因此，将我们的方法扩展到复杂的非线性系统中的处理并获取适当的符号动力学描述是合理的。
虽然 Koopman 算符对相空间的划分在一般的低维混沌系统的分析已得到证实，但我们仍需进一步的研究来扩展到更高的维度，尤其是在具有多个不稳定方向的非线性系统中。在本文中，选取本征值接近 1 的本征函数，我们观察该本征函数的特征，并巧妙的讨论了与之相关的本征函数的特征，我们比较了不同基函数数量情况下的本征函数，最终发现这些本征函数中的极值点分布是一致的，但是随着基函数的增加，出现了新的极值点，这对应了我们更高层级的边界点。因此，在分析动力学特征和划分相空间时，我们有必要通过调整基函数数量的大小来粗化或细化对相空间的描述，这也需要更详细的探讨。
在低维系统中，我们还将系统的演化过程引入了高斯白噪声，用以模拟现实中的涨落。但是 Koopman 算符的本征函数对相空间的划分与无噪声的情况相比并没有太大的区别，这表明我们的方法具有鲁棒性。相空间的划分是否随噪声强度变化以90第四章 总结与展望及如何随噪声强度变化也是一件值得讨论的事情，即理论上应存在一个有限大小的最佳分区。在高维混沌系统中，当我们选取自然演化的基函数时，如二维 Henon 映射中，我们选取 x 方向的演化用于计算 Koopman 算符的矩阵表示，因为在这个方向上有非线性项，对应几何空间中的拉伸和折叠。而在一般的系统中，我们并不能确定哪个方向上最重要，若能通过自动化的计算来确定最关键的维度特征，则系统程序的开发则更具有普适性。当然在实际系统中，通常我们只收集系统的部分数据，甚至可能不包含所需的数据，而从此类数据中能够提取多少信息以及能够提取出怎样的信息也具有重要的现实意义。